

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>isopy.dtypes &mdash; isopy 0.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> isopy
          

          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial_page.html">Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../refpages/dtypes.html">Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../refpages/io.html">Read/Write</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../refpages/toolbox.html">Toolbox</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">isopy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>isopy.dtypes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for isopy.dtypes</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">_np</span>
<span class="kn">import</span> <span class="nn">pyperclip</span> <span class="k">as</span> <span class="nn">_pyperclip</span>
<span class="kn">from</span> <span class="nn">tables</span> <span class="kn">import</span> <span class="n">Table</span> <span class="k">as</span> <span class="n">_Table</span>
<span class="kn">import</span> <span class="nn">inspect</span> <span class="k">as</span> <span class="nn">_inspect</span>
<span class="kn">import</span> <span class="nn">isopy.toolbox.np_func</span> <span class="k">as</span> <span class="nn">_npf</span>
<span class="kn">import</span> <span class="nn">warnings</span> <span class="k">as</span> <span class="nn">_warnings</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MassString&#39;</span><span class="p">,</span> <span class="s1">&#39;ElementString&#39;</span><span class="p">,</span> <span class="s1">&#39;IsotopeString&#39;</span><span class="p">,</span> <span class="s1">&#39;RatioString&#39;</span><span class="p">,</span>
           <span class="s1">&#39;MassList&#39;</span><span class="p">,</span> <span class="s1">&#39;ElementList&#39;</span><span class="p">,</span> <span class="s1">&#39;IsotopeList&#39;</span><span class="p">,</span> <span class="s1">&#39;RatioList&#39;</span><span class="p">,</span>
           <span class="s1">&#39;MassArray&#39;</span><span class="p">,</span> <span class="s1">&#39;ElementArray&#39;</span><span class="p">,</span> <span class="s1">&#39;IsotopeArray&#39;</span><span class="p">,</span> <span class="s1">&#39;RatioArray&#39;</span><span class="p">,</span>
           <span class="s1">&#39;IsopyString&#39;</span><span class="p">,</span> <span class="s1">&#39;IsopyList&#39;</span><span class="p">,</span> <span class="s1">&#39;IsopyArray&#39;</span><span class="p">,</span> <span class="s1">&#39;ReferenceDict&#39;</span><span class="p">,</span>
           <span class="s1">&#39;string&#39;</span><span class="p">,</span>  <span class="s1">&#39;list_&#39;</span><span class="p">,</span> <span class="s1">&#39;aslist&#39;</span><span class="p">,</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;asarray&#39;</span><span class="p">,</span> <span class="s1">&#39;asanyarray&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="string"><a class="viewcode-back" href="../../refpages/Strings/isopy.string.html#isopy.string">[docs]</a><span class="k">def</span> <span class="nf">string</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an :ref:`IsopyString &lt;isopystrings&gt;` from the input.</span>

<span class="sd">    There is no ``asstring`` counterpart because strings are immutable. This means that a string</span>
<span class="sd">    cannot be modified. Any attempt to modify a string will return a new string.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    item : str</span>
<span class="sd">        String to be parsed</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    :class:`MassString`, :class:`ElementString`, :class:`IsotopeString` or :class:`RatioString`</span>
<span class="sd">        :ref:`IsopyString &lt;isopystring&gt;` of *item*. If *item* already is an</span>
<span class="sd">        :ref:`IsopyString &lt;isopystring&gt;` it is returned.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raised if *item* cannot be parsed into an :ref:`isopystring`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; isopy.string(&#39;pd102&#39;)</span>
<span class="sd">    &#39;102Pd&#39;</span>
<span class="sd">    &gt;&gt;&gt; type(isopy.string(105))</span>
<span class="sd">    &#39;MassString&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">IsopyString</span><span class="p">):</span> <span class="k">return</span> <span class="n">item</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MassString</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ElementString</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">IsotopeString</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">RatioString</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">IsopyString</span><span class="p">,</span> <span class="s1">&#39;unable to parse item into one of the IsopyStrings&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="list_"><a class="viewcode-back" href="../../refpages/Lists/isopy.list_.html#isopy.list_">[docs]</a><span class="k">def</span> <span class="nf">list_</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an :ref:`IsopyList &lt;isopylists&gt;` from the input.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    items : str, list of str</span>
<span class="sd">        List of strings to be parsed. If *items* is a str it will be split using the &quot;,&quot; seperator.</span>
<span class="sd">    skip_duplicates : bool</span>
<span class="sd">        If ``True`` all duplicate items will be removed from the list. This only applies during initialisation of the list.</span>
<span class="sd">        Default value is ``False``.</span>
<span class="sd">    allow_duplicates : bool</span>
<span class="sd">        If ``False`` a StringDuplicateError will be raised if the list contains any duplicate items. This only applies</span>
<span class="sd">        during initialisation of the list. Default Value is ``True``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    :class:`MassList`, :class:`ElementList`, :class:`IsotopeList` or :class:`RatioList`</span>
<span class="sd">        :ref:`IsopyList &lt;isopylists&gt;` consisiting of *items*. If *item* already is an</span>
<span class="sd">        :ref:`IsopyList &lt;isopylists&gt;` a copy is returned.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raised if *items* cannot be parsed into an :ref:`IsopyList &lt;isopylists&gt;`</span>
<span class="sd">    StringDuplicateError</span>
<span class="sd">        Raised when a string already exist in the list and ``allow_duplicates = False``</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; isopy.list_([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    [&#39;99Ru&#39;, &#39;105Pd&#39;, &#39;111Cd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; type(isopy.list_([99, 105, &#39;111&#39;]))</span>
<span class="sd">    &#39;MassList&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MassList</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ElementList</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">IsotopeList</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">RatioList</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">IsopyString</span><span class="p">,</span> <span class="s1">&#39;unable to parse items into one of the IsopyLists&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="aslist"><a class="viewcode-back" href="../../refpages/Lists/isopy.aslist.html#isopy.aslist">[docs]</a><span class="k">def</span> <span class="nf">aslist</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the input to a :ref:`IsopyList &lt;isopylists&gt;`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    items : list of str</span>
<span class="sd">        List of strings to be parsed.</span>
<span class="sd">    skip_duplicates : bool</span>
<span class="sd">        If ``True`` all duplicate items will be removed from the list. This only applies during initialisation of the list.</span>
<span class="sd">        Default value is ``False``.</span>
<span class="sd">    allow_duplicates : bool</span>
<span class="sd">        If ``False`` a StringDuplicateError will be raised if the list contains any duplicate items. This only applies</span>
<span class="sd">        during initialisation of the list. Default Value is ``True``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    :class:`MassList`, :class:`ElementList`, :class:`IsotopeList` or :class:`RatioList`</span>
<span class="sd">        :ref:`IsopyList &lt;isopylists&gt;` consisiting of *items*. If *item* already is an</span>
<span class="sd">        :ref:`IsopyList &lt;isopylists&gt;` it is returned instead of a copy if no other parameters</span>
<span class="sd">        are given.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raised if *items* cannot be parsed into an :ref:`IsopyList &lt;isopylists&gt;`</span>
<span class="sd">    StringDuplicateError</span>
<span class="sd">        Raised when a string already exist in the list and ``allow_duplicates = False``</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = isopy.aslist([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    &gt;&gt;&gt; b = isopy.aslist(a)</span>
<span class="sd">    &gt;&gt;&gt; a is b</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; c = isopy.list_(a)</span>
<span class="sd">    &gt;&gt;&gt; a is c</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; a == c</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">IsopyList</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">skip_duplicates</span> <span class="ow">and</span> <span class="n">items</span><span class="o">.</span><span class="n">has_duplicates</span><span class="p">():</span>
            <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">items</span><span class="o">.</span><span class="n">remove_duplicates</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">items</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">allow_duplicates</span> <span class="ow">and</span> <span class="n">items</span><span class="o">.</span><span class="n">has_duplicated</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;list contains duplicate items&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">items</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">list_</span><span class="p">(</span><span class="n">items</span><span class="p">)</span></div>


<div class="viewcode-block" id="array"><a class="viewcode-back" href="../../refpages/Arrays/isopy.array.html#isopy.array">[docs]</a><span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an :ref:`IsopyArray &lt;IsopyArrays&gt;` from the input.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : int, dict, list, ndarray, :ref:`IsopyArray &lt;isopyarray&gt;`</span>
<span class="sd">        * If *values* is an integer then an array of size *values* will be created with every value set to 0. Requires</span>
<span class="sd">          the *keys* keyword.</span>

<span class="sd">        * If *values* is a dict each item in the dict will be a column in the array. The key of the item will be used</span>
<span class="sd">          as the key of the column. The the size of each item in the dict all have the same size.</span>

<span class="sd">        * If *values* is a one dimensional list or ndarray then the size of the list must have the same as the *keys*.</span>

<span class="sd">        * If *values* is a two dimensional list or ndarray then the second dimension must have the same size as *keys*.</span>

<span class="sd">        * If *values* is is an structured numpy array and *keys* is not given then the ``dtype.names`` will be used</span>
<span class="sd">          as keys. If *keys* is given then the the size of *keys* must be the same as ``dtype.names``.</span>

<span class="sd">        * If *values* is an :class:`RatioArray` and *keys* is not given then a copy of the array is returned.</span>

<span class="sd">        * If *values* is an :ref:`IsopyArray &lt;isopyarray&gt;` and *keys* is given then a copy of the array with the new</span>
<span class="sd">          keys will be returned.</span>

<span class="sd">    keys : list of str, optional</span>
<span class="sd">        A list of the columns keys of the array. Does not have to be given the column keys can be inferred from *values*.</span>
<span class="sd">    ndim : {-1, 0, 1}, optional</span>
<span class="sd">        The number of dimensions the array should have. If -1 then it will make a zero dimensional array if possible</span>
<span class="sd">        otherwise it will make a one dimensional array. If not given *ndim* is inferred from *values*. Will raise</span>
<span class="sd">        ValueError is array cannot be made with the specified dimensions.</span>
<span class="sd">    dtype : numpy.dtype</span>
<span class="sd">        Can be any type accepted by numpy. All columns in the array will have the same dtype. For *values* that are</span>
<span class="sd">        not numpy.ndarray object the default value is ``np.float``. For numpy.ndarray objects the default value is</span>
<span class="sd">        inferred from the object. If *values* contains more than one dtype a common dtype will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    :class:`MassList`, :class:`ElementList`, :class:`IsotopeList` or :class:`RatioList`</span>
<span class="sd">        :ref:`IsopyArray &lt;isopyarrays&gt;` interpretation of *values*. If *values* already is an</span>
<span class="sd">        :ref:`IsopyArray &lt;isopyarrays&gt;` a copy is returned.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raised if input cannot be parsed into an :ref:`IsopyArray &lt;IsopyArrays&gt;`</span>
<span class="sd">    StringDuplicateError</span>
<span class="sd">        Raised when a string already exist in the list and ``allow_duplicates = False``</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = isopy.array([[1,2,3],[4,5,6]], [&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    &gt;&gt;&gt; print(a)</span>
<span class="sd">    99Ru, 105Pd, 111Cd</span>
<span class="sd">    1.0 , 2.0  , 3.0</span>
<span class="sd">    4.0 , 5.0  , 6.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MassArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ElementArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">IsotopeArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">RatioArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to convert input to IsopyArray&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="asarray"><a class="viewcode-back" href="../../refpages/Arrays/isopy.asarray.html#isopy.asarray">[docs]</a><span class="k">def</span> <span class="nf">asarray</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the input to a :ref:`IsopyArray &lt;isopyarrays&gt;`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : int, dict, list, ndarray, :ref:`IsopyArray &lt;isopyarray&gt;`</span>
<span class="sd">        * If *values* is an integer then an array of size *values* will be created with every value set to 0. Requires</span>
<span class="sd">          the *keys* keyword.</span>

<span class="sd">        * If *values* is a dict each item in the dict will be a column in the array. The key of the item will be used</span>
<span class="sd">          as the key of the column. The the size of each item in the dict all have the same size.</span>

<span class="sd">        * If *values* is a one dimensional list or ndarray then the size of the list must have the same as the *keys*.</span>

<span class="sd">        * If *values* is a two dimensional list or ndarray then the second dimension must have the same size as *keys*.</span>

<span class="sd">        * If *values* is is an structured numpy array and *keys* is not given then the ``dtype.names`` will be used</span>
<span class="sd">          as keys. If *keys* is given then the the size of *keys* must be the same as ``dtype.names``.</span>

<span class="sd">        * If *values* is an :class:`RatioArray` and *keys* is not given then a copy of the array is returned.</span>

<span class="sd">        * If *values* is an :ref:`IsopyArray &lt;isopyarray&gt;` and *keys* is given then a copy of the array with the new</span>
<span class="sd">          keys will be returned.</span>

<span class="sd">    keys : list of str, optional</span>
<span class="sd">        A list of the columns keys of the array. Does not have to be given the column keys can be inferred from *values*.</span>
<span class="sd">    ndim : {-1, 0, 1}, optional</span>
<span class="sd">        The number of dimensions the array should have. If -1 then it will make a zero dimensional array if possible</span>
<span class="sd">        otherwise it will make a one dimensional array. If not given *ndim* is inferred from *values*. Will raise</span>
<span class="sd">        ValueError is array cannot be made with the specified dimensions.</span>
<span class="sd">    dtype : numpy.dtype</span>
<span class="sd">        Can be any type accepted by numpy. All columns in the array will have the same dtype. For *values* that are</span>
<span class="sd">        not numpy.ndarray object the default value is ``np.float``. For numpy.ndarray objects the default value is</span>
<span class="sd">        inferred from the object. If *values* contains more than one dtype a common dtype will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    :class:`MassArray`, :class:`ElementArray`, :class:`IsotopeArray` or :class:`RatioArray`</span>
<span class="sd">        :ref:`IsopyArray &lt;isopyarrays&gt;` interpretation of *values*. If *values* already is an</span>
<span class="sd">        :ref:`IsopyArray &lt;isopyarrays&gt;` it is returned instead of a copy if no other parameters</span>
<span class="sd">        are given.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raised if input cannot be parsed into an :ref:`isopyarray`.</span>
<span class="sd">    StringDuplicateError</span>
<span class="sd">        Raised when a string already exist in the list and ``allow_duplicates = False``</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = isopy.array([[1,2,3],[4,5,6]], [&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    &gt;&gt;&gt; print(a)</span>
<span class="sd">    99Ru, 105Pd, 111Cd</span>
<span class="sd">    1.0 , 2.0  , 3.0</span>
<span class="sd">    4.0 , 5.0  , 6.0</span>

<span class="sd">    &gt;&gt;&gt; a = isopy.asarray([[1,2,3],[4,5,6]], [&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    &gt;&gt;&gt; b = isopy.asarray(a)</span>
<span class="sd">    &gt;&gt;&gt; a is b</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; c = isopy.array(a)</span>
<span class="sd">    &gt;&gt;&gt; a is c</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; a == c</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">IsopyArray</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">keys</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">values</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">!=</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ndim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="n">ndim</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">values</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span></div>


<div class="viewcode-block" id="asanyarray"><a class="viewcode-back" href="../../refpages/Arrays/isopy.asanyarray.html#isopy.asanyarray">[docs]</a><span class="k">def</span> <span class="nf">asanyarray</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the input to a :ref:`IsopyArray &lt;isopyarrays&gt;` or an numpy.ndarray`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : array_like</span>
<span class="sd">        Input data, in any form that can be converted to an array. This includes lists, lists of tuples, tuples,</span>
<span class="sd">        tuples of tuples, tuples of lists, ndarrays and :ref:`IsopyArrays`.</span>
<span class="sd">    dtype : numpy.dtype</span>
<span class="sd">        Can be any type accepted by numpy.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    :ref:`IsopyArray &lt;isopyarrays&gt;` or numpy.ndarray</span>
<span class="sd">        If input cannot be converted to an :ref:`IsopyArray &lt;isopyarrays&gt;` it will converted to an ndarray using</span>
<span class="sd">        `numpy.asarray &lt;https://numpy.org/doc/stable/reference/generated/numpy.asarray.html&gt;`_.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = isopy.array([[1,2,3],[4,5,6]], [&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    &gt;&gt;&gt; print(a)</span>
<span class="sd">    99Ru, 105Pd, 111Cd</span>
<span class="sd">    1.0 , 2.0  , 3.0</span>
<span class="sd">    4.0 , 5.0  , 6.0</span>
<span class="sd">    &gt;&gt;&gt; b = isopy.array([[1,2,3],[4,5,6]])</span>
<span class="sd">    &gt;&gt;&gt; print(b)</span>
<span class="sd">    [[1 2 3]</span>
<span class="sd">     [4 5 6]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span></div>


<span class="c1">##################</span>
<span class="c1">### Exceptions ###</span>
<span class="c1">##################</span>

<span class="k">def</span> <span class="nf">classname</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span> <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>


<span class="k">class</span> <span class="nc">IsopyException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">IsopyParseException</span><span class="p">(</span><span class="n">IsopyException</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">StringParseError</span><span class="p">(</span><span class="n">IsopyParseException</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">additional_information</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="n">string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cls</span> <span class="o">=</span> <span class="bp">cls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additional_information</span> <span class="o">=</span> <span class="n">additional_information</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: unable to parse &quot;</span><span class="si">{}</span><span class="s1">&quot;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cls</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_information</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_information</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">message</span>


<span class="k">class</span> <span class="nc">StringTypeError</span><span class="p">(</span><span class="n">IsopyParseException</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cls</span> <span class="o">=</span> <span class="bp">cls</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: cannot convert </span><span class="si">{}</span><span class="s1"> into </span><span class="se">\&#39;</span><span class="s1">str</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cls</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">StringDuplicateError</span><span class="p">(</span><span class="n">IsopyException</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">listobj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="n">string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listobj</span> <span class="o">=</span> <span class="n">listobj</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: Duplicate of &quot;</span><span class="si">{}</span><span class="s1">&quot; found in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">message</span>


<span class="k">class</span> <span class="nc">ListSizeError</span><span class="p">(</span><span class="n">IsopyException</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">listobj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">other</span> <span class="o">=</span> <span class="n">other</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listobj</span> <span class="o">=</span> <span class="n">listobj</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: Length of </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> does not match current list (</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">),</span>
                                                    <span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">ListTypeError</span><span class="p">(</span><span class="n">IsopyException</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">listobj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">other</span> <span class="o">=</span> <span class="n">other</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected</span> <span class="o">=</span> <span class="n">expected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listobj</span> <span class="o">=</span> <span class="n">listobj</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: Item must be a </span><span class="si">{}</span><span class="s1"> not </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">),</span> <span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">),</span>
                                                     <span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">NumeratorTypeError</span><span class="p">(</span><span class="n">ListTypeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: Numerator must be a </span><span class="si">{}</span><span class="s1"> not </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">),</span> <span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">),</span>
                                                     <span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">DenominatorTypeError</span><span class="p">(</span><span class="n">ListTypeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: Denominator must be a </span><span class="si">{}</span><span class="s1"> not </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">),</span> <span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">),</span>
                                                     <span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expected</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">NoCommomDenominator</span><span class="p">(</span><span class="n">IsopyException</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listobj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listobj</span> <span class="o">=</span> <span class="n">listobj</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: List does not have a common denominator&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listobj</span><span class="p">))</span>


<span class="c1">#############</span>
<span class="c1">### Types ###</span>
<span class="c1">#############</span>
<span class="k">class</span> <span class="nc">IsopyType</span><span class="p">:</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;IsopyType not specified&#39;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strings</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;IsopyType not specified&#39;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;IsopyType not specified&#39;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_ndarray</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;IsopyType not specified&#39;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_void</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;IsopyType not specified&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MassType</span><span class="p">:</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MassString</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strings</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MassList</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MassArray</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_void</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="n">MassVoid</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_ndarray</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">MassNdarray</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ElementType</span><span class="p">:</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ElementString</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strings</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ElementList</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ElementArray</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_void</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="n">ElementVoid</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_ndarray</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">ElementNdarray</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">IsotopeType</span><span class="p">:</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">IsotopeString</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strings</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">IsotopeList</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">IsotopeArray</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_void</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="n">IsotopeVoid</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_ndarray</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">IsotopeNdarray</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">RatioType</span><span class="p">:</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioString</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strings</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioList</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioArray</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_void</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="n">RatioVoid</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_ndarray</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">RatioNdarray</span><span class="p">)</span>


<span class="c1">##############</span>
<span class="c1">### String ###</span>
<span class="c1">##############</span>
<span class="k">class</span> <span class="nc">IsopyString</span><span class="p">(</span><span class="n">IsopyType</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="n">_warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;please use isopy.string instead&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsopyString</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#This function should return a string that can safely be used as variable name</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>


<div class="viewcode-block" id="MassString"><a class="viewcode-back" href="../../refpages/Strings/isopy.MassString.html#isopy.MassString">[docs]</a><span class="k">class</span> <span class="nc">MassString</span><span class="p">(</span><span class="n">MassType</span><span class="p">,</span> <span class="n">IsopyString</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    MassString(string)</span>

<span class="sd">    String representation of an integer representing a mass number.</span>

<span class="sd">    The supplied string must consist only of digits. :class:`MassString` can also be initialised with an integer.</span>

<span class="sd">    Behaves just like, and contains all the methods that, a normal python string does. However, any method that</span>
<span class="sd">    returns a string will return a normal python string and *not* an :class:`MassString` unless specifically noted below.</span>
<span class="sd">    Only methods that behave differently from a normal string are documented below.</span>

<span class="sd">    The MassString will behave as an integer when used with the ``==``, ``!=``, ``&lt;``, ``&lt;=``, ``&gt;`` and ``&gt;=``</span>
<span class="sd">    operators. If used in conjunction with a string it will be converted to a float before the operation.</span>

<span class="sd">    Can be made into an :class:`RatioString` using the ``/`` operator and an :class:`IsotopeString` using the ``+``</span>
<span class="sd">    operator.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    StringParseError</span>
<span class="sd">        Is raised when the supplied string cannot be parsed into the correct format</span>
<span class="sd">    StringTypeError</span>
<span class="sd">        Raised when the supplied item cannot be turned into a string</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; isopy.MassString(&#39;76&#39;)</span>
<span class="sd">    &#39;76&#39;</span>
<span class="sd">    &gt;&gt;&gt; isopy.MassString(70)</span>
<span class="sd">    &#39;70&#39;</span>

<span class="sd">    Comparisons</span>

<span class="sd">    &gt;&gt;&gt; isopy.MassString(&#39;76&#39;) == 76</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; isopy.MassString(&#39;76&#39;) == &#39;76&#39;</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; isopy.MassString(&#39;76&#39;) != 76</span>
<span class="sd">    False</span>

<span class="sd">    Using ``+ and /``</span>

<span class="sd">    &gt;&gt;&gt; isopy.MassString(&#39;76&#39;) / &#39;ge&#39;</span>
<span class="sd">    &#39;76/Ge&#39;</span>
<span class="sd">    &gt;&gt;&gt; &#39;ge&#39; / isopy.MassString(&#39;76&#39;)</span>
<span class="sd">    &#39;Ge/76&#39;</span>
<span class="sd">    &gt;&gt;&gt; &#39;ge&#39; + isopy.MassString(&#39;76&#39;)</span>
<span class="sd">    &#39;76Ge&#39;</span>
<span class="sd">    &gt;&gt;&gt; isopy.MassString(&#39;76&#39;) + &#39;ge&#39;</span>
<span class="sd">    &#39;76Ge&#39;</span>

<span class="sd">    Using ``&lt;, &lt;=, &gt; and &gt;=``</span>

<span class="sd">    &gt;&gt;&gt; isopy.MassString(&#39;76&#39;) &gt; 70</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; isopy.MassString(&#39;76&#39;) &lt;= &#39;76&#39;</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">string</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">StringTypeError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>

        <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;Cannot parse empty string&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">elif</span> <span class="n">string</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Mass_&#39;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">string</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;Can only contain numerical characters&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;Must be a positive integer&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">str</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

<div class="viewcode-block" id="MassString.identifier"><a class="viewcode-back" href="../../refpages/Strings/isopy.MassString.html#isopy.MassString.identifier">[docs]</a>    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns descriptive identifier that can be used to e.g. name attributes.</span>

<span class="sd">        The returned string can be parsed back into an :class:`MassString` the same as any other string.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; isopy.MassString(76).identifier()</span>
<span class="sd">        &#39;Mass_76&#39;</span>
<span class="sd">        &gt;&gt;&gt; isopy.MassString(&#39;Mass_76&#39;)</span>
<span class="sd">        &#39;76&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A string that can be used as a variable name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;Mass_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MassString</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;unable to convert &quot;</span><span class="si">{}</span><span class="s1">&quot; to float&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__ge__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;unable to convert &quot;</span><span class="si">{}</span><span class="s1">&quot; to float&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__le__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;unable to convert &quot;</span><span class="si">{}</span><span class="s1">&quot; to float&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__gt__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;unable to convert &quot;</span><span class="si">{}</span><span class="s1">&quot; to float&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__lt__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">ElementString</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">IsotopeString</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioString</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioString</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span></div>


<div class="viewcode-block" id="ElementString"><a class="viewcode-back" href="../../refpages/Strings/isopy.ElementString.html#isopy.ElementString">[docs]</a><span class="k">class</span> <span class="nc">ElementString</span><span class="p">(</span><span class="n">ElementType</span><span class="p">,</span> <span class="n">IsopyString</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ElementString(string)</span>

<span class="sd">    String representation of an element symbol.</span>

<span class="sd">    The supplied string will automatically be formatted such that the first letter is always in upper case</span>
<span class="sd">    and, if present, the second letter will always be in lower case. :class:`ElementString` is limited to two characters.</span>

<span class="sd">    Behaves just like, and contains all the methods that, a normal python string does. However, any method that</span>
<span class="sd">    return a string will return a normal python string and *not* an :class:`ElementString` unless specifically noted below.</span>
<span class="sd">    Only methods that behave differently from a normal string are documented below.</span>

<span class="sd">    When compared to another item that item will, if possible, be converted to an :class:`ElementString` for comparison.</span>

<span class="sd">    Can be made into an :class:`RatioString` using the ``/`` operator and an :class:`IsotopeString` using the ``+``</span>
<span class="sd">    operator.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    StringParseError</span>
<span class="sd">        Is raised when the supplied string cannot be parsed into the correct format</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; isopy.ElementString(&#39;ge&#39;)</span>
<span class="sd">    &#39;Ge&#39;</span>

<span class="sd">    Comparisons</span>

<span class="sd">    &gt;&gt;&gt; isopy.ElementString(&#39;Ge&#39;) == &#39;ge&#39;</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; isopy.ElementString(&#39;Ge&#39;) != &#39;ge&#39;</span>
<span class="sd">    False</span>

<span class="sd">    Using ``+ and /``</span>

<span class="sd">    &gt;&gt;&gt; isopy.ElementString(&#39;Ge&#39;) / &#39;Pd&#39;</span>
<span class="sd">    &#39;Ge/Pd&#39;</span>
<span class="sd">    &gt;&gt;&gt; &#39;Pd&#39; / isopy.ElementString(&#39;Ge&#39;)</span>
<span class="sd">    &#39;Pd/Ge&#39;</span>
<span class="sd">    &gt;&gt;&gt; isopy.ElementString(&#39;Ge&#39;) + &#39;76&#39;</span>
<span class="sd">    &#39;76Ge&#39;</span>
<span class="sd">    &gt;&gt;&gt; 76 + isopy.ElementString(&#39;Ge&#39;)</span>
<span class="sd">    &#39;76Ge&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">string</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;Cannot parse empty string&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">string</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Element_&#39;</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;ElementString is limited to two characters&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">string</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span> <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span>
                                                            <span class="s1">&#39;ElementString is limited to alphabetical characters&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">str</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StringTypeError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>

<div class="viewcode-block" id="ElementString.identifier"><a class="viewcode-back" href="../../refpages/Strings/isopy.ElementString.html#isopy.ElementString.identifier">[docs]</a>    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns descriptive identifier that can be used to e.g. name attributes.</span>

<span class="sd">        The returned string can be parsed back into an :class:`ElementString` the same as any other string.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; isopy.ElementString(&#39;Ge&#39;).identifier()</span>
<span class="sd">        &#39;Element_Ge&#39;</span>
<span class="sd">        &gt;&gt;&gt; isopy.Elementstring(&#39;Element_Ge&#39;)</span>
<span class="sd">        &#39;Ge&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A string that can be used as a variable name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;Element_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioString</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioString</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">mass</span> <span class="o">=</span> <span class="n">MassString</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">IsotopeString</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></div>


<div class="viewcode-block" id="IsotopeString"><a class="viewcode-back" href="../../refpages/Strings/isopy.IsotopeString.html#isopy.IsotopeString">[docs]</a><span class="k">class</span> <span class="nc">IsotopeString</span><span class="p">(</span><span class="n">IsotopeType</span><span class="p">,</span> <span class="n">IsopyString</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    IsotopeString(string)</span>

<span class="sd">    String representation of an isotope containing a mass number followed by an element symbol.</span>

<span class="sd">    The supplied string should consist of a mass number and an element symbol that will be parsed into a :class:`MassString` and</span>
<span class="sd">    an :class:`ElementString`, respectively. The mass number can occur before or after the element symbol.</span>

<span class="sd">    Behaves just like, and contains all the methods that, a normal python string does. However, any method that</span>
<span class="sd">    return a string will return a normal python string and *not* an :class:`IsotopeString` unless specifically noted below.</span>
<span class="sd">    Only methods that behave differently from a normal string are documented below.&#39;</span>

<span class="sd">    When compared to another item that item will, if possible, be converted to an :class:`IsotopeString` for comparison.</span>
<span class="sd">    The ``in`` operator will check if the given item is equal to either the mass number or element symbol</span>

<span class="sd">    Can be made into an :class:`RatioString` using the ``/`` operator.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    StringParseError</span>
<span class="sd">        Is raised when the supplied string cannot be parsed into the correct format</span>
<span class="sd">    StringTypeError</span>
<span class="sd">        Raised when the supplied item cannot be turned into a string</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    mass_number : MassString</span>
<span class="sd">        The mass number of the :class:`IsotopeString`</span>
<span class="sd">    element_symbol : ElementString</span>
<span class="sd">        The element symbol of the :class:`IsotopeString`</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; isopy.IsotopeString(&#39;ge76&#39;)</span>
<span class="sd">    &#39;76Ge&#39;</span>
<span class="sd">    &gt;&gt;&gt; isopy.IsotopeString(&#39;ge76&#39;).mass_number</span>
<span class="sd">    &#39;76&#39;</span>
<span class="sd">    &gt;&gt;&gt; isopy.IsotopeString(&#39;ge76&#39;).element_symbol</span>
<span class="sd">    &#39;Ge&#39;</span>

<span class="sd">    Comparisons</span>

<span class="sd">    &gt;&gt;&gt; isopy.IsotopeString(&#39;76Ge&#39;) == &#39;ge76&#39;</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; isopy.IsotopeString(&#39;76Ge&#39;) != &#39;ge76&#39;</span>
<span class="sd">    False</span>

<span class="sd">    Using ``in``</span>

<span class="sd">    &gt;&gt;&gt; &#39;ge&#39; in isopy.IsotopeString(&#39;ge76&#39;)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; &#39;70&#39; in isopy.IsotopeString(&#39;ge76&#39;)</span>
<span class="sd">    False</span>

<span class="sd">    Using ``/``</span>

<span class="sd">    &gt;&gt;&gt; isopy.IsotopeString(&#39;Ge76&#39;) / &#39;70ge&#39;</span>
<span class="sd">    &#39;76Ge/70Ge&#39;</span>
<span class="sd">    &gt;&gt;&gt; &#39;72Ge&#39; / isopy.IsotopeString(&#39;Ge76&#39;)</span>
<span class="sd">    &#39;72Ge/76Ge&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">string</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;Cannot parse empty string&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">elif</span> <span class="n">string</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Isotope_&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>

            <span class="c1"># If no digits in string then only Symbol is given.</span>
            <span class="k">if</span> <span class="n">string</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;string does not contain a mass number&#39;</span><span class="p">)</span>

            <span class="c1"># If only digits then only mass number</span>
            <span class="k">if</span> <span class="n">string</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;string does not contain an element symbol&#39;</span><span class="p">)</span>

            <span class="c1"># Loop through to split</span>
            <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">string</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>

                <span class="c1"># a = mass number and b = Symbol</span>
                <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                    <span class="n">mass</span> <span class="o">=</span> <span class="n">MassString</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="n">ElementString</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">element</span><span class="p">))</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">_mass_number</span> <span class="o">=</span> <span class="n">mass</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">_element_symbol</span> <span class="o">=</span> <span class="n">element</span>
                    <span class="k">return</span> <span class="n">obj</span>

                <span class="c1"># b = mass number and a = Symbol</span>
                <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                    <span class="n">mass</span> <span class="o">=</span> <span class="n">MassString</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="n">ElementString</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">element</span><span class="p">))</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">_mass_number</span> <span class="o">=</span> <span class="n">mass</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">_element_symbol</span> <span class="o">=</span> <span class="n">element</span>
                    <span class="k">return</span> <span class="n">obj</span>
            <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;unable to separate string into a mass number and an element symbol&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StringTypeError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mass_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mass_number</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">element_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_element_symbol</span>

<div class="viewcode-block" id="IsotopeString.identifier"><a class="viewcode-back" href="../../refpages/Strings/isopy.IsotopeString.html#isopy.IsotopeString.identifier">[docs]</a>    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns descriptive identifier that can be used to e.g. name attributes.</span>

<span class="sd">        The returned string can be parsed back into an :class:`IsotopeString` the same as any other string.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; isopy.IsotopeString(&#39;Ge76&#39;).identifier()</span>
<span class="sd">        &#39;Isotope_76Ge&#39;</span>
<span class="sd">        &gt;&gt;&gt; isopy.IsotopeString(&#39;Isotope_76Ge&#39;)</span>
<span class="sd">        &#39;76Ge&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A string that can be used as a variable name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;Isotope_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return **True** if `string` is equal to the IsotopeString&#39;s mass number or element symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>       
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_number</span> <span class="o">==</span> <span class="n">string</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_symbol</span> <span class="o">==</span> <span class="n">string</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioString</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioString</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span></div>


<div class="viewcode-block" id="RatioString"><a class="viewcode-back" href="../../refpages/Strings/isopy.RatioString.html#isopy.RatioString">[docs]</a><span class="k">class</span> <span class="nc">RatioString</span><span class="p">(</span><span class="n">RatioType</span><span class="p">,</span> <span class="n">IsopyString</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RatioString(string)</span>

<span class="sd">    String representation of a ratio consisting of a numerator and a denominator.</span>

<span class="sd">    The supplied string should consist of a numerator and a denominator separated by a &#39;/&#39;. The numerator and</span>
<span class="sd">    denominator strings must be able to be parsed into a :class:`MassString`, :class:`ElementString` or a</span>
<span class="sd">    :class:`IsotopeString`. The numerator and denominator do not have to be the same type.</span>

<span class="sd">    Behaves just like, and contains all the methods that, a normal python string does. However, any method that</span>
<span class="sd">    return a string will return a normal python string and *not* an :class:`RatioString` unless specifically noted below.</span>
<span class="sd">    Only methods that behave differently from a normal string are documented below.</span>

<span class="sd">    When compared to another item that item will, if possible, be converted to an :class:`RatioString` for comparison.</span>
<span class="sd">    The ``in`` operator will check if the given item is equal to either the numerator or denominator.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    StringParseError</span>
<span class="sd">        Is raised when the supplied string cannot be parsed into the correct format</span>
<span class="sd">    StringTypeError</span>
<span class="sd">        Raised when the supplied item cannot be turned into a string</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    numerator : MassString, ElementString or IsotopeString</span>
<span class="sd">        The numerator string in the :class:`RatioString`. **Readonly**</span>
<span class="sd">    denominator : MassString, ElementString or IsotopeString</span>
<span class="sd">        The denominator string in the :class:`RatioString`. **Readonly**</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; isopy.RatioString(&#39;ge76/ge70&#39;)</span>
<span class="sd">    &#39;76Ge/70Ge&#39;</span>
<span class="sd">    &gt;&gt;&gt; isopy.RatioString(&#39;ge76&#39;).numerator</span>
<span class="sd">    &#39;76Ge&#39;</span>
<span class="sd">    &gt;&gt;&gt; isopy.RatioString(&#39;ge76&#39;).denominator</span>
<span class="sd">    &#39;70Ge&#39;</span>

<span class="sd">    Comparisons</span>

<span class="sd">    &gt;&gt;&gt; isopy.RatioString(&#39;ge76/70ge&#39;) == &#39;ge76/70ge&#39;</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; isopy.RatioString(&#39;ge76/70ge&#39;) != &#39;ge76/70ge&#39;</span>
<span class="sd">    False</span>

<span class="sd">    Using ``in``</span>

<span class="sd">    &gt;&gt;&gt; &#39;76ge&#39; in isopy.RatioString(&#39;ge76/70ge&#39;)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; &#39;75ge&#39; isopy.RatioString(&#39;ge76/70ge&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">string</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">string</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Ratio_&#39;</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_OVER_&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;unable to split string into numerator and denominator&#39;</span><span class="p">)</span>
            <span class="n">numer</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">numer</span> <span class="o">=</span> <span class="n">MassString</span><span class="p">(</span><span class="n">numer</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">numer</span> <span class="o">=</span> <span class="n">ElementString</span><span class="p">(</span><span class="n">numer</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">numer</span> <span class="o">=</span> <span class="n">IsotopeString</span><span class="p">(</span><span class="n">numer</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;unable to parse numerator&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">denom</span> <span class="o">=</span> <span class="n">MassString</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">denom</span> <span class="o">=</span> <span class="n">ElementString</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">denom</span> <span class="o">=</span> <span class="n">IsotopeString</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">IsopyParseException</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">StringParseError</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;unable to parse denominator&#39;</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">))</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_numerator</span> <span class="o">=</span> <span class="n">numer</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_denominator</span> <span class="o">=</span> <span class="n">denom</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StringTypeError</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">numerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_numerator</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">denominator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_denominator</span>

<div class="viewcode-block" id="RatioString.identifier"><a class="viewcode-back" href="../../refpages/Strings/isopy.RatioString.html#isopy.RatioString.identifier">[docs]</a>    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns descriptive identifier that can be used to e.g. name attributes.</span>

<span class="sd">        The returned string can be parsed back into an :class:`RatioString` the same as any other string.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; isopy.RatioString(&#39;Ge76/Ge70&#39;).identifier()</span>
<span class="sd">        &#39;Ratio_76Ge_70Ge&#39;</span>
<span class="sd">        &gt;&gt;&gt; isopy.RatioString(&#39;Ratio_76Ge_70Ge&#39;)</span>
<span class="sd">        &#39;76Ge/70Ge&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;Ratio_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numerator</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return **True** if `string` is equal to the RatioString&#39;s numerator or denominator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">numerator</span> <span class="o">==</span> <span class="n">string</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="o">==</span> <span class="n">string</span></div>


<span class="c1">############</span>
<span class="c1">### List ###</span>
<span class="c1">############</span>
<span class="k">class</span> <span class="nc">IsopyList</span><span class="p">(</span><span class="n">IsopyType</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">_warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;please use isopy.list instead&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="n">allow_duplicates</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span> <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span><span class="p">]</span>

        <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">skip_duplicates</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="k">while</span> <span class="n">items</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="n">items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">allow_duplicates</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">StringDuplicateError</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
    
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return **True** if all items in `other` is the same all items in the list. Order is not important</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span> <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">other</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
    
    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return **True** if `item` is present in the list. If `item` is a list then return **True**</span>
<span class="sd">        if all items in that list are present in the list. Otherwise return **False**.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the item at `index`. `index` can be int, slice or sequence of int.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">([</span><span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">other</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="nb">list</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">other</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]))</span>

    <span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="nb">list</span><span class="o">.</span><span class="fm">__add__</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">other</span><span class="p">],</span>
                                           <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">other</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]))</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">item</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">StringParseError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> is not in list&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">StringParseError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> is not in list&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an item to the end of the list. If ``skip_duplicates = True`` the item will only be added if it is not</span>
<span class="sd">        already in the list. If ``allow_duplicated = False`` a StringDuplucateError will be raised if item is already</span>
<span class="sd">        present in the list.</span>

<span class="sd">        ``skip_duplicates`` and ``allow_duplicate`` options does not apply to items already present in the list.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        StringDuplicateError</span>
<span class="sd">            Raised when a string already exist in the list and ``allow_duplicates = False``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">skip_duplicates</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">allow_duplicates</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StringDuplicateError</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extend the list by appending all the items. If ``skip_duplicates = True`` only those items not already present in</span>
<span class="sd">        the list will be added. If ``allow_duplicated = False`` a StringDuplucateError will be raised if any item is already</span>
<span class="sd">        present in the list.</span>

<span class="sd">        ``skip_duplicates`` and ``allow_duplicate`` options do not apply for items already present in the list.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        StringDuplicateError</span>
<span class="sd">            Raised when a string already exist in the list and ``allow_duplicates = False``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> object is not iterable&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">items</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">skip_duplicates</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">allow_duplicates</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">StringDuplicateError</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">IsopyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">identifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of identifiers for each item in the list. Equivalent to ``[item.identifier() for item in self]``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">has_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if the list contains duplicates items. Otherwise it returns ``False``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">remove_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all duplicate item in the list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>


<div class="viewcode-block" id="MassList"><a class="viewcode-back" href="../../refpages/Lists/isopy.MassList.html#isopy.MassList">[docs]</a><span class="k">class</span> <span class="nc">MassList</span><span class="p">(</span><span class="n">MassType</span><span class="p">,</span> <span class="n">IsopyList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    MassList(items, skip_duplicates=False, allow_duplicates=True)</span>

<span class="sd">    A list consisting exclusively of :class:`MassString` items.</span>

<span class="sd">    Behaves just like, and contains all the methods, that a normal python list does unless otherwise noted. All methods</span>
<span class="sd">    that would normally return a list will instead return a :class:`MassList`. Only methods that behave differently from</span>
<span class="sd">    a normal python list are documented below.</span>

<span class="sd">    When comparing the list against another list the order of items is not considered.</span>
<span class="sd">    The ``in`` operator can be used both with a single item or a list. If it is a list it will return ``True`` if</span>
<span class="sd">    all item in the other list is present in the list.</span>

<span class="sd">    Get item can be an int or a list of integers. However, set item only accepts a single integer.</span>

<span class="sd">    The ``&amp;``, ``|`` and ``^`` operators can be used in combination with another list for an unordered item to item</span>
<span class="sd">    comparison. The and (``&amp;``) operator will return the items that occur in both lists. The or (``|``) operator</span>
<span class="sd">    will return all items that appear in at least one of the lists. The xor (``^``) operator will return the items</span>
<span class="sd">    that do not appear in both lists. All duplicate items will be removed from the returned lists.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    items : str, MassArray, iterable</span>
<span class="sd">        Each item in the iterable will be :class:`MassString`. If items is a string it will be split into a list using the</span>
<span class="sd">        &#39;,&#39; seperator.  If items is an :class:`MassArray` it will use the keys from that array to make the list.</span>
<span class="sd">    skip_duplicates : bool</span>
<span class="sd">        If ``True`` all duplicate items will be removed from the list. This only applies during initialisation of the list.</span>
<span class="sd">        Default value is ``False``.</span>
<span class="sd">    allow_duplicates : bool</span>
<span class="sd">        If ``False`` a StringDuplicateError will be raised if the list contains any duplicate items. This only applies</span>
<span class="sd">        during initialisation of the list. Default Value is ``True``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    StringDuplicateError</span>
<span class="sd">        Raised when a string already exist in the list and ``allow_duplicates = False``</span>
<span class="sd">    ListLengthError</span>
<span class="sd">        Raised when there is a size mismatch between this list and another list</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; MassList([99, 105, &#39;111&#39;])</span>
<span class="sd">    [&#39;99&#39;, &#39;105&#39;, &#39;111&#39;]</span>
<span class="sd">    &gt;&gt;&gt; MassList(&#39;99, 105,111&#39;)</span>
<span class="sd">    [&#39;99&#39;, &#39;105&#39;, &#39;111&#39;]</span>

<span class="sd">    Comparisons and ``in``</span>
<span class="sd">    &gt;&gt;&gt; MassList([99, 105, &#39;111&#39;]) == [111, 105, 99]</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; &#39;105&#39; in MassList([99, 105, &#39;111&#39;])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; [&#39;105&#39;, 111] in MassList([99, 105, &#39;111&#39;])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; [&#39;105&#39;, 107] in MassList([99, 105, &#39;111&#39;])</span>
<span class="sd">    False</span>

<span class="sd">    Indexing</span>

<span class="sd">    &gt;&gt;&gt; MassList([99, 105, &#39;111&#39;])[[0,2]</span>
<span class="sd">    [&#39;99&#39;, &#39;111&#39;]</span>

<span class="sd">    Using ``&amp;``, ``|`` and ``^``</span>

<span class="sd">    &gt;&gt;&gt; MassList([99, 105, &#39;111&#39;]) &amp; [105, 107, &#39;111&#39;]</span>
<span class="sd">    [&#39;105&#39;, &#39;111&#39;]</span>
<span class="sd">    &gt;&gt;&gt; MassList([99, 105, &#39;111&#39;]) | [105, 107, &#39;111&#39;]</span>
<span class="sd">    [&#39;99&#39;, &#39;105&#39;, &#39;111&#39;, &#39;107&#39;]</span>
<span class="sd">    &gt;&gt;&gt; MassList([99, 105, &#39;111&#39;]) ^ [105, 107, &#39;111&#39;]</span>
<span class="sd">    [&#39;99&#39;, &#39;107&#39;]</span>

<span class="sd">    Using ``/`` and ``+``</span>

<span class="sd">    &gt;&gt;&gt; MassList([99, 105, &#39;111&#39;]) / 108</span>
<span class="sd">    [&#39;99/108&#39;, &#39;105/108&#39;, &#39;111/108&#39;]</span>
<span class="sd">    &gt;&gt;&gt; MassList([99, 105, &#39;111&#39;]) / [108, 109, &#39;110&#39;]</span>
<span class="sd">    [&#39;99/108&#39;, &#39;105/109&#39;, &#39;111/110&#39;]</span>
<span class="sd">    &gt;&gt;&gt; MassList([99, 105, &#39;111&#39;]) + &#39;pd&#39;</span>
<span class="sd">    [&#39;99Pd&#39;, &#39;105Pd&#39;, &#39;111Pd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; [&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;] + MassList([99, 105, &#39;111&#39;])</span>
<span class="sd">    [&#39;99Ru&#39;, &#39;105Pd&#39;, &#39;111Cd&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">list</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denominator</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominator</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ListSizeError</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">denominator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">denominator</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numerator</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">numerator</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ListSizeError</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="n">numerator</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="n">numerator</span> <span class="o">/</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ListSizeError</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IsotopeList</span><span class="p">([</span><span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">IsotopeList</span><span class="p">([</span><span class="n">other</span> <span class="o">+</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_filter_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_list</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mass_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mass_number_not</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mass_number_lt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">mass_number_gt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mass_number_le</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mass_number_ge</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">_unused_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks each index in *index_list* against the keyword arguments and return a a list with the indexes that</span>
<span class="sd">        satisfy the keyword arguments.</span>

<span class="sd">        This is called by the *copy* method and potentially by the copy method of other lists.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            list of int</span>
<span class="sd">                A list of the indexes that satisfy the keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">_unused_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot; not a valid filter for MassList&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">mass_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mass_number</span><span class="p">,</span> <span class="n">MassList</span><span class="p">):</span>
            <span class="n">mass_number</span> <span class="o">=</span> <span class="n">MassList</span><span class="p">(</span><span class="n">mass_number</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mass_number_not</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mass_number_not</span><span class="p">,</span> <span class="n">MassList</span><span class="p">):</span>
            <span class="n">mass_number_not</span> <span class="o">=</span> <span class="n">MassList</span><span class="p">(</span><span class="n">mass_number_not</span><span class="p">)</span>

        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">:</span>
            <span class="n">iso</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">mass_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">iso</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mass_number</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="n">mass_number_not</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">mass_number_not</span><span class="p">:</span> <span class="k">continue</span>

            <span class="k">if</span> <span class="n">mass_number_lt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">iso</span> <span class="o">&gt;=</span> <span class="n">mass_number_lt</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="n">mass_number_gt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">iso</span> <span class="o">&lt;=</span> <span class="n">mass_number_gt</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="n">mass_number_le</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">iso</span> <span class="o">&gt;</span> <span class="n">mass_number_le</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="n">mass_number_ge</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">iso</span> <span class="o">&lt;</span> <span class="n">mass_number_ge</span><span class="p">:</span> <span class="k">continue</span>

            <span class="c1"># The item satisfies all the keyword arguments given.</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span>


<div class="viewcode-block" id="MassList.copy"><a class="viewcode-back" href="../../refpages/Lists/isopy.MassList.html#isopy.MassList.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mass_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mass_number_not</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mass_number_lt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mass_number_gt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">mass_number_le</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mass_number_ge</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        copy(*, element_symbol = None, element_symbol_not = None)</span>

<span class="sd">        Returns a copy of the list.</span>

<span class="sd">        If keyword arguments are given then only those items in the list that satisfy these arguments are copied.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mass_number : MassString, MassList, optional</span>
<span class="sd">           Only items in the list matching/found in ``mass_number`` are copied.</span>
<span class="sd">        mass_number_not : MassString, MassList, optional</span>
<span class="sd">           Only items in the list not matching/not found in ``mass_number`` are copied.</span>
<span class="sd">        mass_number_lt : MassString, optional</span>
<span class="sd">            Only items in the list a mass number less than this value are copied.</span>
<span class="sd">        mass_number_gt : MassString, optional</span>
<span class="sd">            Only items in the list a mass number greater than this value are copied.</span>
<span class="sd">        mass_number_le : MassString, optional</span>
<span class="sd">            Only items in the list a mass number less than or equal to this value are copied.</span>
<span class="sd">        mass_number_ge : MassString, optional</span>
<span class="sd">            Only items in the list a mass number greater than or equal to this value are copied.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MassList</span>
<span class="sd">            A copy of the items in the list that satisfy the keyword arguments or all items in the list if none are</span>
<span class="sd">            given.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; MassList([&#39;99&#39;, &#39;105&#39;, &#39;111&#39;]).copy(mass_number=[105, 107, 111])</span>
<span class="sd">        [&#39;105&#39;, &#39;111&#39;]</span>
<span class="sd">        &gt;&gt;&gt; MassList([&#39;99&#39;, &#39;105&#39;, &#39;111&#39;]).copy(mass_number_not=&#39;111&#39;])</span>
<span class="sd">        [&#39;99&#39;, &#39;105&#39;]</span>
<span class="sd">        &gt;&gt;&gt; MassList([&#39;99&#39;, &#39;105&#39;, &#39;111&#39;]).copy(mass_number_gt=&#39;99&#39;])</span>
<span class="sd">        [&#39;105&#39;, &#39;111&#39;]</span>
<span class="sd">        &gt;&gt;&gt; MassList([&#39;99&#39;, &#39;105&#39;, &#39;111&#39;]).copy(mass_number_le=105])</span>
<span class="sd">        [&#39;99&#39;, &#39;105&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        copy(*,mass_number = None,  mass_number_not = None, mass_number_lt=None, mass_number_gt=None, mass_number_le=None, mass_number_ge=None)</span>

<span class="sd">        Returns a copy of the current list.  *DESCRIPTION*</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mass_number : MassInteger, MassList, optional</span>
<span class="sd">            Only MassIntegers matching this string/found in this list will pass.</span>
<span class="sd">        mass_number_not : MassInteger, MassList, optional</span>
<span class="sd">            Only MassIntegers not matching this string/not found in this list will pass.</span>
<span class="sd">        </span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MassList</span>
<span class="sd">            A new MassList with each MassInteger in the list that passed the filters.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_indexes</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">mass_number</span><span class="o">=</span><span class="n">mass_number</span><span class="p">,</span> <span class="n">mass_number_not</span><span class="o">=</span><span class="n">mass_number_not</span><span class="p">,</span>
                                     <span class="n">mass_number_lt</span><span class="o">=</span><span class="n">mass_number_lt</span><span class="p">,</span> <span class="n">mass_number_gt</span><span class="o">=</span><span class="n">mass_number_gt</span><span class="p">,</span>
                                     <span class="n">mass_number_le</span><span class="o">=</span><span class="n">mass_number_le</span><span class="p">,</span> <span class="n">mass_number_ge</span><span class="o">=</span><span class="n">mass_number_ge</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="ElementList"><a class="viewcode-back" href="../../refpages/Lists/isopy.ElementList.html#isopy.ElementList">[docs]</a><span class="k">class</span> <span class="nc">ElementList</span><span class="p">(</span><span class="n">ElementType</span><span class="p">,</span> <span class="n">IsopyList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ElementList(items, skip_duplicates=False, allow_duplicates=True)</span>

<span class="sd">    A list consisting exclusively of :class:`ElementString` items.</span>

<span class="sd">    Behaves just like, and contains all the methods, that a normal python list does unless otherwise noted. All methods</span>
<span class="sd">    that would normally return a list will instead return a :class:`ElementList`. Only methods that behave differently from</span>
<span class="sd">    a normal python list are documented below.</span>

<span class="sd">    When comparing the list against another list the order of items is not considered.</span>
<span class="sd">    The ``in`` operator can be used both with a single item or a list. If it is a list it will return ``True`` if</span>
<span class="sd">    all item in the other list is present in the list.</span>

<span class="sd">    Get item can be an int or a list of integers. However, set item only accepts a single integer.</span>

<span class="sd">    The ``&amp;``, ``|`` and ``^`` operators can be used in combination with another list for an unordered item to item</span>
<span class="sd">    comparison. The and (``&amp;``) operator will return the items that occur in both lists. The or (``|``) operator</span>
<span class="sd">    will return all items that appear in at least one of the lists. The xor (``^``) operator will return the items</span>
<span class="sd">    that do not appear in both lists. All duplicate items will be removed from the returned lists.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    items : str, ElementArray, iterable</span>
<span class="sd">        Each item in the iterable will be :class:`ElementString`. If items is a string it will be split into a list using the</span>
<span class="sd">        &#39;,&#39; seperator.  If items is an :class:`ElementArray` it will use the keys from that array to make the list.</span>
<span class="sd">    skip_duplicates : bool</span>
<span class="sd">        If ``True`` all duplicate items will be removed from the list. This only applies during initialisation of the list.</span>
<span class="sd">        Default value is ``False``.</span>
<span class="sd">    allow_duplicates : bool</span>
<span class="sd">        If ``False`` a StringDuplicateError will be raised if the list contains any duplicate items. This only applies</span>
<span class="sd">        during initialisation of the list. Default Value is ``True``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    StringDuplicateError</span>
<span class="sd">        Raised when a string already exist in the list and ``allow_duplicates = False``</span>
<span class="sd">    ListLengthError</span>
<span class="sd">        Raised when there is a size mismatch between this list and another list</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;])</span>
<span class="sd">    [&#39;Ru&#39;, &#39;Pd&#39;, &#39;Cd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; ElementList(&#39;ru, pd,cd&#39;)</span>
<span class="sd">    [&#39;Ru&#39;, &#39;Pd&#39;, &#39;Cd&#39;]</span>

<span class="sd">    Comparisons and ``in``</span>
<span class="sd">    &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]) == [&#39;cd&#39;, &#39;pd&#39;, &#39;ru&#39;]</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; &#39;pd&#39; in ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; [&#39;pd&#39;, &#39;cd&#39;] in ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; [&#39;pd&#39;, &#39;ag&#39;] in ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;])</span>
<span class="sd">    False</span>

<span class="sd">    Indexing</span>

<span class="sd">    &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;])[[0,2]</span>
<span class="sd">    [&#39;Ru&#39;, &#39;Cd&#39;]</span>

<span class="sd">    Using ``&amp;``, ``|`` and ``^``</span>

<span class="sd">    &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]) &amp; [&#39;pd&#39;, &#39;ag&#39;, &#39;cd&#39;]</span>
<span class="sd">    [&#39;Pd&#39;, &#39;Cd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]) | [&#39;pd&#39;, &#39;ag&#39;, &#39;cd&#39;]</span>
<span class="sd">    [&#39;Ru&#39;, &#39;Pd&#39;, &#39;Cd&#39;, &#39;Ag&#39;]</span>
<span class="sd">    &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]) ^ [&#39;pd&#39;, &#39;ag&#39;, &#39;cd&#39;]</span>
<span class="sd">    [&#39;Ru&#39;, &#39;Ag&#39;]</span>

<span class="sd">    Using ``/`` and ``+``</span>

<span class="sd">    &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]) / &#39;pd&#39;</span>
<span class="sd">    [&#39;Ru/Pd&#39;, &#39;Pd/Pd&#39;, &#39;Cd/Pd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; [&#39;108pd&#39;, &#39;109Pd&#39;, &#39;110Pd&#39;] / ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;])</span>
<span class="sd">    [&#39;108Pd/Ru&#39;, &#39;109Pd/Pd&#39;, &#39;110Pd/Cd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]) + &#39;99&#39;</span>
<span class="sd">    [&#39;99Ru&#39;, &#39;99Pd&#39;, &#39;99Cd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; [99, 105, 111] + ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;])</span>
<span class="sd">    [&#39;99Ru&#39;, &#39;105Pd&#39;, &#39;111Cd&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">list</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denominator</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominator</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ListSizeError</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">denominator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">denominator</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numerator</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">numerator</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ListSizeError</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="n">numerator</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="n">numerator</span> <span class="o">/</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ListSizeError</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">IsotopeList</span><span class="p">([</span><span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">IsotopeList</span><span class="p">([</span><span class="n">other</span> <span class="o">+</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_filter_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_list</span><span class="p">,</span> <span class="n">element_symbol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">element_symbol_not</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">_unused_kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">_unused_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot; not a valid filter for ElementList&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">element_symbol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element_symbol</span><span class="p">,</span> <span class="n">ElementList</span><span class="p">):</span>
            <span class="n">element_symbol</span> <span class="o">=</span> <span class="n">ElementList</span><span class="p">(</span><span class="n">element_symbol</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">element_symbol_not</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element_symbol_not</span><span class="p">,</span> <span class="n">ElementList</span><span class="p">):</span>
            <span class="n">element_symbol_not</span> <span class="o">=</span> <span class="n">ElementList</span><span class="p">(</span><span class="n">element_symbol_not</span><span class="p">)</span>

        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">:</span>
            <span class="n">ele</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">element_symbol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ele</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">element_symbol</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="n">element_symbol_not</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">element_symbol_not</span><span class="p">:</span> <span class="k">continue</span>

            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span>

<div class="viewcode-block" id="ElementList.copy"><a class="viewcode-back" href="../../refpages/Lists/isopy.ElementList.html#isopy.ElementList.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">element_symbol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">element_symbol_not</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        copy(*, element_symbol = None, element_symbol_not = None)</span>

<span class="sd">        Returns a copy of the list.</span>

<span class="sd">        If keyword arguments are given then only those items in the list that satisfy these arguments are copied.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        element_symbol : ElementString, ElementList, optional</span>
<span class="sd">           Only items in the list matching/found in ``element_symbol`` are copied.</span>
<span class="sd">        element_symbol_not : ElementString, ElementList, optional</span>
<span class="sd">           Only items in the list not matching/not found in ``element_symbol_not`` are copied.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ElementList</span>
<span class="sd">            A copy of the items in the list that satisfy the keyword arguments or all items in the list if none are</span>
<span class="sd">            given.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]).copy(element_symbol=[&#39;pd&#39;,&#39;ag&#39;, &#39;cd&#39;])</span>
<span class="sd">        [&#39;Pd&#39;, &#39;Cd]</span>
<span class="sd">        &gt;&gt;&gt; ElementList([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]).copy(element_symbol_not=&#39;cd&#39;)</span>
<span class="sd">        [&#39;Ru&#39;, &#39;Pd&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_indexes</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">element_symbol</span><span class="o">=</span><span class="n">element_symbol</span><span class="p">,</span> <span class="n">element_symbol_not</span><span class="o">=</span><span class="n">element_symbol_not</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="IsotopeList"><a class="viewcode-back" href="../../refpages/Lists/isopy.IsotopeList.html#isopy.IsotopeList">[docs]</a><span class="k">class</span> <span class="nc">IsotopeList</span><span class="p">(</span><span class="n">IsotopeType</span><span class="p">,</span> <span class="n">IsopyList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    IsotopeList(items, skip_duplicates=False, allow_duplicates=True)</span>

<span class="sd">    A list consisting exclusively of :class:`IsotopeString` items.</span>

<span class="sd">    Behaves just like, and contains all the methods, that a normal python list does unless otherwise noted. All methods</span>
<span class="sd">    that would normally return a list will instead return a :class:`IsotopeList`. Only methods that behave differently from</span>
<span class="sd">    a normal python list are documented below.</span>

<span class="sd">    When comparing the list against another list the order of items is not considered.</span>
<span class="sd">    The ``in`` operator can be used both with a single item or a list. If it is a list it will return ``True`` if</span>
<span class="sd">    all item in the other list is present in the list.</span>

<span class="sd">    Get item can be an int or a list of integers. However, set item only accepts a single integer.</span>

<span class="sd">    The ``&amp;``, ``|`` and ``^`` operators can be used in combination with another list for an unordered item to item</span>
<span class="sd">    comparison. The and (``&amp;``) operator will return the items that occur in both lists. The or (``|``) operator</span>
<span class="sd">    will return all items that appear in at least one of the lists. The xor (``^``) operator will return the items</span>
<span class="sd">    that do not appear in both lists. All duplicate items will be removed from the returned lists.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    items : str, IsotopeArray, iterable</span>
<span class="sd">        Each item in the iterable will be :class:`IsotopeString`. If items is a string it will be split into a list using the</span>
<span class="sd">        &#39;,&#39; seperator.  If items is an :class:`IsotopeArray` it will use the keys from that array to make the list.</span>
<span class="sd">    skip_duplicates : bool</span>
<span class="sd">        If ``True`` all duplicate items will be removed from the list. This only applies during initialisation of the list.</span>
<span class="sd">        Default value is ``False``.</span>
<span class="sd">    allow_duplicates : bool</span>
<span class="sd">        If ``False`` a StringDuplicateError will be raised if the list contains any duplicate items. This only applies</span>
<span class="sd">        during initialisation of the list. Default Value is ``True``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    StringDuplicateError</span>
<span class="sd">        Raised when a string already exist in the list and ``allow_duplicates = False``</span>
<span class="sd">    ListLengthError</span>
<span class="sd">        Raised when there is a size mismatch between this list and another list</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    [&#39;99Ru&#39;, &#39;105Pd&#39;, &#39;111Cd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; IsotopeList(&#39;99ru, 105pd,cd111&#39;)</span>
<span class="sd">    [&#39;99Ru&#39;, &#39;105Pd&#39;, &#39;111Cd&#39;]</span>

<span class="sd">    Comparisons and ``in``</span>

<span class="sd">    &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]) == [&#39;111cd&#39;, &#39;105pd&#39;,  &#39;99ru&#39;, ]</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; &#39;105pd&#39; in IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; [&#39;105pd&#39;, &#39;111cd&#39;] in IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; [&#39;105pd&#39;, &#39;107ag&#39;] in IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    False</span>

<span class="sd">    Indexing</span>

<span class="sd">    &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])[[0,2]</span>
<span class="sd">    [&#39;99Ru&#39;, &#39;111Cd&#39;]</span>

<span class="sd">    Using ``&amp;``, ``|`` and ``^``</span>

<span class="sd">    &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]) &amp; [&#39;105pd&#39;, &#39;107ag&#39;, &#39;111cd&#39;]</span>
<span class="sd">    [&#39;105Pd&#39;, &#39;111Cd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]) | [&#39;105pd&#39;, &#39;107ag&#39;, &#39;111cd&#39;]</span>
<span class="sd">    [&#39;99Ru&#39;, &#39;105Pd&#39;, &#39;111Cd&#39;, &#39;107Ag&#39;]</span>
<span class="sd">    &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]) ^ [&#39;105pd&#39;, &#39;107ag&#39;, &#39;111cd&#39;]</span>
<span class="sd">    [&#39;99Ru&#39;, &#39;107Ag&#39;]</span>

<span class="sd">    Using ``/``</span>

<span class="sd">    &gt;&gt;&gt; ElementList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]) / &#39;108pd&#39;</span>
<span class="sd">    [&#39;99Ru/108Pd&#39;, &#39;105Pd/108Pd&#39;, &#39;111Cd/108Pd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; [&#39;108pd&#39;, &#39;109Pd&#39;, &#39;110Pd&#39;] / ElementList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;])</span>
<span class="sd">    [&#39;108Pd/99Ru&#39;, &#39;109Pd/105Pd&#39;, &#39;110Pd/111Cd&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">list</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denominator</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominator</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ListSizeError</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">denominator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">denominator</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numerator</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">numerator</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ListSizeError</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="n">numerator</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RatioList</span><span class="p">([</span><span class="n">numerator</span> <span class="o">/</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

<div class="viewcode-block" id="IsotopeList.mass_numbers"><a class="viewcode-back" href="../../refpages/Lists/isopy.IsotopeList.html#isopy.IsotopeList.mass_numbers">[docs]</a>    <span class="k">def</span> <span class="nf">mass_numbers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :class:`MassList` containing the mass number of each item in the list.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]).mass_numbers()</span>
<span class="sd">        [&#39;99&#39;, &#39;105&#39;, &#39;111&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">MassList</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">mass_number</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span></div>

<div class="viewcode-block" id="IsotopeList.element_symbols"><a class="viewcode-back" href="../../refpages/Lists/isopy.IsotopeList.html#isopy.IsotopeList.element_symbols">[docs]</a>    <span class="k">def</span> <span class="nf">element_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an :class:`ElementList` containing the element symbol of each item in the list.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]).element_symbols()</span>
<span class="sd">        [&#39;Ru&#39;, &#39;Pd&#39;, &#39;Cd&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ElementList</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">element_symbol</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span></div>

    <span class="k">def</span> <span class="nf">_filter_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_list</span><span class="p">,</span> <span class="n">isotope</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">isotope_not</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">mass_number_and_element_symbol_filters</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">isotope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">isotope</span><span class="p">,</span> <span class="n">IsotopeList</span><span class="p">):</span>
            <span class="n">isotope</span> <span class="o">=</span> <span class="n">IsotopeList</span><span class="p">(</span><span class="n">isotope</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isotope_not</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">isotope_not</span><span class="p">,</span> <span class="n">IsotopeList</span><span class="p">):</span>
            <span class="n">isotope_not</span> <span class="o">=</span> <span class="n">IsotopeList</span><span class="p">(</span><span class="n">isotope_not</span><span class="p">)</span>

        <span class="n">element_filters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">mass_filters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">mass_number_and_element_symbol_filters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="k">if</span> <span class="s1">&#39;mass_number&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="n">mass_filters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass_number_and_element_symbol_filters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s1">&#39;element_symbol&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="n">element_filters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass_number_and_element_symbol_filters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot; not a valid filter for IsotopeList&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>

        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">:</span>
            <span class="n">iso</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">isotope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">iso</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">isotope</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="n">isotope_not</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotope_not</span><span class="p">:</span> <span class="k">continue</span>

            <span class="c1"># It has passed all the tests above</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">element_filters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_symbols</span><span class="p">()</span><span class="o">.</span><span class="n">_filter_indexes</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">element_filters</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mass_filters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_numbers</span><span class="p">()</span><span class="o">.</span><span class="n">_filter_indexes</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">mass_filters</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span>

<div class="viewcode-block" id="IsotopeList.copy"><a class="viewcode-back" href="../../refpages/Lists/isopy.IsotopeList.html#isopy.IsotopeList.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">isotope</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">isotope_not</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">mass_number_and_element_symbol_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        copy(*, isotope = None, isotope_not = None, **mass_number_and_element_symbol_kwargs)</span>

<span class="sd">        Returns a copy of the list.</span>

<span class="sd">        If keyword arguments are given then only those items in the list that satisfy these arguments are copied.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        isotope : IsotopeString, IsotopeList, optional</span>
<span class="sd">           Only items in the list matching/found in ``isotope`` are copied.</span>
<span class="sd">        isotope_not : IsotopeString, IsotopeList, optional</span>
<span class="sd">           Only items in the list not matching/not found in ``isotope_not`` are copied.</span>
<span class="sd">        **mass_number_and_element_symbol_kwargs</span>
<span class="sd">            See :func:`MassList.copy` and :func:`Element.copy` for additional keyword arguments.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        IsotopeList</span>
<span class="sd">            A copy of the items in the list that satisfy the keyword arguments or all items in the list if none are</span>
<span class="sd">            given.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]).copy(isotope=[&#39;105pd&#39;,&#39;107ag&#39;, &#39;111cd&#39;])</span>
<span class="sd">        [&#39;105Pd&#39;, &#39;111Cd]</span>
<span class="sd">        &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]).copy(isotope_not=&#39;111cd&#39;)</span>
<span class="sd">        [&#39;99Ru&#39;, &#39;105Pd&#39;]</span>
<span class="sd">        &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]).copy(mass_number_gt = 100)</span>
<span class="sd">        [&#39;105Pd&#39;, &#39;111Cd]</span>
<span class="sd">        &gt;&gt;&gt; IsotopeList([&#39;99ru&#39;, &#39;105pd&#39;, &#39;111cd&#39;]).copy(element_not=&#39;pd&#39;])</span>
<span class="sd">        [&#39;99Ru&#39;, &#39;111Cd]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_indexes</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">isotope</span><span class="o">=</span><span class="n">isotope</span><span class="p">,</span> <span class="n">isotope_not</span><span class="o">=</span><span class="n">isotope_not</span><span class="p">,</span>
                                     <span class="o">**</span><span class="n">mass_number_and_element_symbol_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="RatioList"><a class="viewcode-back" href="../../refpages/Lists/isopy.RatioList.html#isopy.RatioList">[docs]</a><span class="k">class</span> <span class="nc">RatioList</span><span class="p">(</span><span class="n">RatioType</span><span class="p">,</span> <span class="n">IsopyList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RatioList(items, skip_duplicates=False, allow_duplicates=True)</span>

<span class="sd">    A list consisting exclusively of :class:`RatioString` items.</span>

<span class="sd">    The numerator of all items in the list must be the same type of item. The same is true for the denominator. However,</span>
<span class="sd">    the numerators and the denominators do not need to be of the same type.</span>

<span class="sd">    Behaves just like, and contains all the methods, that a normal python list does unless otherwise noted. All methods</span>
<span class="sd">    that would normally return a list will instead return a :class:`IsotopeString`. Only methods that behave differently from</span>
<span class="sd">    a normal python list are documented below.</span>

<span class="sd">    When comparing the list against another list the order of items is not considered.</span>
<span class="sd">    The ``in`` operator can be used both with a single item or a list. If it is a list it will return ``True`` if</span>
<span class="sd">    all item in the other list is present in the list.</span>

<span class="sd">    Get item can be an int or a list of integers. However, set item only accepts a single integer.</span>

<span class="sd">    The ``&amp;``, ``|`` and ``^`` operators can be used in combination with another list for an unordered item to item</span>
<span class="sd">    comparison. The and (``&amp;``) operator will return the items that occur in both lists. The or (``|``) operator</span>
<span class="sd">    will return all items that appear in at least one of the lists. The xor (``^``) operator will return the items</span>
<span class="sd">    that do not appear in both lists. All duplicate items will be removed from the returned lists.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    items : str, RatioArray, iterable</span>
<span class="sd">        Each item in the iterable will be :class:`RatioString`. If items is a string it will be split into a list using the</span>
<span class="sd">        &#39;,&#39; seperator.  If items is an :class:`RatioArray` it will use the keys from that array to make the list.</span>
<span class="sd">    skip_duplicates : bool</span>
<span class="sd">        If ``True`` all duplicate items will be removed from the list. This only applies during initialisation of the list.</span>
<span class="sd">        Default value is ``False``.</span>
<span class="sd">    allow_duplicates : bool</span>
<span class="sd">        If ``False`` a StringDuplicateError will be raised if the list contains any duplicate items. This only applies</span>
<span class="sd">        during initialisation of the list. Default Value is ``True``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    StringDuplicateError</span>
<span class="sd">        Raised when a string already exist in the list and ``allow_duplicates = False``</span>
<span class="sd">    NumeratorTypeError</span>
<span class="sd">        Raised when the numerator of a :class:`RatioString` does is not the same type as the</span>
<span class="sd">        other numerators in the list.</span>
<span class="sd">    DenominatorTypeError</span>
<span class="sd">        Raised when the denominator of a :class:`RatioString` does is not the same type as the</span>
<span class="sd">        other denominators in the list.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;])</span>
<span class="sd">    [&#39;99Ru/108Pd&#39;, &#39;105Pd/108Pd&#39;, &#39;111Cd/108Pd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; RatioList(&#39;99ru/108Pd, 105pd/108Pd,cd111/108Pd&#39;)</span>
<span class="sd">    [&#39;99Ru/108Pd&#39;, &#39;105Pd/108Pd&#39;, &#39;111Cd/108Pd&#39;]</span>

<span class="sd">    Comparisons and ``in``</span>

<span class="sd">    &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]) == [&#39;111cd/108Pd&#39;, &#39;105pd/108Pd&#39;,  &#39;99ru/108Pd&#39;]</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; &#39;105pd&#39; in RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; [&#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;] in RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; [&#39;105pd/108Pd&#39;, &#39;107ag/108Pd&#39;] in RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;])</span>
<span class="sd">    False</span>

<span class="sd">    Indexing</span>

<span class="sd">    &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;])[[0,2]</span>
<span class="sd">    [&#39;99Ru/108Pd&#39;, &#39;111Cd/108Pd&#39;]</span>

<span class="sd">    Using ``&amp;``, ``|`` and ``^``</span>

<span class="sd">    &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]) &amp; [&#39;105pd/108Pd&#39;, &#39;107ag/108Pd&#39;, &#39;111cd/108Pd&#39;]</span>
<span class="sd">    [&#39;105Pd/108Pd&#39;, &#39;111Cd/108Pd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]) | [&#39;105pd/108Pd&#39;, &#39;107ag/108Pd&#39;, &#39;111cd/108Pd&#39;]</span>
<span class="sd">    [&#39;99Ru/108Pd&#39;, &#39;105Pd/108Pd&#39;, &#39;111Cd/108Pd&#39;, &#39;107Ag/108Pd&#39;]</span>
<span class="sd">    &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]) ^ [&#39;105pd/108Pd&#39;, &#39;107ag/108Pd&#39;, &#39;111cd/108Pd&#39;]</span>
<span class="sd">    [&#39;99Ru/108Pd&#39;, &#39;107Ag/108Pd&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">list</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_numerator_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_denominator_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RatioList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">skip_duplicates</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">RatioString</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_numerator_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_numerator_type</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">numerator</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">numerator</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_numerator_type</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">NumeratorTypeError</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">numerator</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_numerator_type</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_denominator_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_denominator_type</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">denominator</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_denominator_type</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">DenominatorTypeError</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_denominator_type</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">string</span>

<div class="viewcode-block" id="RatioList.numerators"><a class="viewcode-back" href="../../refpages/Lists/isopy.RatioList.html#isopy.RatioList.numerators">[docs]</a>    <span class="k">def</span> <span class="nf">numerators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return either a :class:`MassList`, :class:`ElementList` or a :class:`RatioList` containing the numerator of each</span>
<span class="sd">        item in the list.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]).numerators()</span>
<span class="sd">        [&#39;99Ru&#39;, &#39;105Pd&#39;, &#39;111Cd&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_numerator_type</span><span class="o">.</span><span class="n">_list</span><span class="p">([</span><span class="n">rat</span><span class="o">.</span><span class="n">numerator</span> <span class="k">for</span> <span class="n">rat</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span></div>

<div class="viewcode-block" id="RatioList.denominators"><a class="viewcode-back" href="../../refpages/Lists/isopy.RatioList.html#isopy.RatioList.denominators">[docs]</a>    <span class="k">def</span> <span class="nf">denominators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns either a :class:`MassList`, :class:`ElementList` or a :class:`RatioList` containing the denominator of each</span>
<span class="sd">        item in the list.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]).numerators()</span>
<span class="sd">        [&#39;108Pd&#39;, &#39;108Pd&#39;, &#39;108Pd&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_denominator_type</span><span class="o">.</span><span class="n">_list</span><span class="p">([</span><span class="n">rat</span><span class="o">.</span><span class="n">denominator</span> <span class="k">for</span> <span class="n">rat</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span></div>

<div class="viewcode-block" id="RatioList.has_common_denominator"><a class="viewcode-back" href="../../refpages/Lists/isopy.RatioList.html#isopy.RatioList.has_common_denominator">[docs]</a>    <span class="k">def</span> <span class="nf">has_common_denominator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denominator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if the all the items in the list have the same denominator. Otherwise returns ``False``.</span>

<span class="sd">        If the optional ``denominator`` argument is given then ``True`` will only be returned if</span>
<span class="sd">        the list has a common denominator equal to this string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        denominator : MassString, ElementString, IsotopeString, optional</span>
<span class="sd">            Should be given to check if the list has a specific common denominator</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]).has_common_denominator()</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]).has_common_denominator(&#39;105Pd&#39;)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_common_denominator</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">denominator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">denom</span> <span class="o">==</span> <span class="n">denominator</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="RatioList.get_common_denominator"><a class="viewcode-back" href="../../refpages/Lists/isopy.RatioList.html#isopy.RatioList.get_common_denominator">[docs]</a>    <span class="k">def</span> <span class="nf">get_common_denominator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the common denominator string for each item in the list.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NoCommonDenominator</span>
<span class="sd">            Raised if the list does not contain a common denominator</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]).get_common_denominator()</span>
<span class="sd">        &#39;108Pd&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominators</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;RatioList is empty&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">denom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">denom</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="k">if</span> <span class="n">denom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">d</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;RatioList does not have a common denominator&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">denom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">_filter_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_list</span><span class="p">,</span> <span class="n">ratio</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ratio_not</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">numerator_and_denominator_filters</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ratio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="n">RatioList</span><span class="p">):</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">RatioList</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ratio_not</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ratio_not</span><span class="p">,</span> <span class="n">RatioList</span><span class="p">):</span>
            <span class="n">ratio_not</span> <span class="o">=</span> <span class="n">RatioList</span><span class="p">(</span><span class="n">ratio_not</span><span class="p">)</span>

        <span class="n">numerator_filters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">denominator_filters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">numerator_and_denominator_filters</span><span class="p">:</span>
            <span class="n">ks</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;numerator&#39;</span> <span class="ow">or</span> <span class="n">ks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">numerator_filters</span><span class="p">[</span><span class="n">ks</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">numerator_and_denominator_filters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;numerator filter parameter not specified for value &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numerator_and_denominator_filters</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">ks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;denominator&#39;</span> <span class="ow">or</span> <span class="n">ks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">denominator_filters</span><span class="p">[</span><span class="n">ks</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">numerator_and_denominator_filters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;denominator filter not specified for value &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numerator_and_denominator_filters</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot; not a valid filter for RatioList&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>

        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">:</span>
            <span class="n">rat</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ratio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rat</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ratio</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="n">ratio_not</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rat</span> <span class="ow">in</span> <span class="n">ratio_not</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">numerator_filters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numerators</span><span class="p">()</span><span class="o">.</span><span class="n">_filter_indexes</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">numerator_filters</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominator_filters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominators</span><span class="p">()</span><span class="o">.</span><span class="n">_filter_indexes</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">denominator_filters</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span>

<div class="viewcode-block" id="RatioList.copy"><a class="viewcode-back" href="../../refpages/Lists/isopy.RatioList.html#isopy.RatioList.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ratio</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ratio_not</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">numerator_and_denominator_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        copy(*, ratio = None, ratio_not = None, **numerator_and_denominator_kwargs)</span>

<span class="sd">        Returns a copy of the list.</span>

<span class="sd">        If keyword arguments are given then only those items in the list that satisfy these arguments are copied.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ratio : RatioString, RatioList, optional</span>
<span class="sd">           Only items in the list matching/found in ``ratio`` are copied.</span>
<span class="sd">        ratio_not : RatioString, RatioList, optional</span>
<span class="sd">           Only items in the list not matching/not found in ``ratio_not`` are copied.</span>
<span class="sd">        **numerator_and_denominator_kwargs</span>
<span class="sd">            See :func:`MassList.copy`, :func:`Element.copy` and :func:`IsotopeList.copy` for additional keyword</span>
<span class="sd">            arguments. These arguments must be preceded by either &#39;numerator\_&#39; or &#39;denominator\_&#39; to specify where the</span>
<span class="sd">            keywords should be used.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        RatioList</span>
<span class="sd">            A copy of the items in the list that satisfy the keyword arguments or all items in the list if none are</span>
<span class="sd">            given.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]).copy(ratio=[&#39;105pd/108Pd&#39;,&#39;107ag/108Pd&#39;, &#39;111cd/108Pd&#39;])</span>
<span class="sd">        [&#39;105Pd/108Pd&#39;, &#39;111Cd/108Pd&#39;]</span>
<span class="sd">        &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]).copy(ratio_not=&#39;111cd/108Pd&#39;)</span>
<span class="sd">        [&#39;99Ru/108Pd&#39;, &#39;105Pd/108Pd&#39;]</span>
<span class="sd">        &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]).copy(numerator_isotope = [&#39;pd&#39;, &#39;ag&#39;, &#39;cd&#39;])</span>
<span class="sd">        [&#39;105Pd/108Pd&#39;, &#39;111Cd/108Pd&#39;]</span>
<span class="sd">        &gt;&gt;&gt; RatioList([&#39;99ru/108Pd&#39;, &#39;105pd/108Pd&#39;, &#39;111cd/108Pd&#39;]).copy(numerator_mass_number_lt = 100)</span>
<span class="sd">        [&#39;99Ru/108Pd&#39;, &#39;105Pd/108Pd&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_indexes</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="n">ratio</span><span class="p">,</span> <span class="n">ratio_not</span><span class="o">=</span><span class="n">ratio_not</span><span class="p">,</span>
                                     <span class="o">**</span><span class="n">numerator_and_denominator_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></div></div>


<span class="c1">############</span>
<span class="c1">### Dict ###</span>
<span class="c1">############</span>
<div class="viewcode-block" id="ReferenceDict"><a class="viewcode-back" href="../../refpages/Dicts/isopy.ReferenceDict.html#isopy.ReferenceDict">[docs]</a><span class="k">class</span> <span class="nc">ReferenceDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ReferenceDict(dictionary = None)</span>

<span class="sd">    Custom dictionary where every item stores a single value as float64 with an :ref:`IsopyString &lt;isopystring&gt;` key.</span>

<span class="sd">    All values are stored in a zero-dimensional numpy array as a 64-bit floating-point number.</span>

<span class="sd">    Behaves just like, and contains all the methods, that a normal dictionary does unless otherwise noted. All methods</span>
<span class="sd">    that takes a key argument will raise a StringParseError if the key cannot be converted to an</span>
<span class="sd">    :ref:`IsopyString &lt;isopystring&gt;`.  Only methods that behave differently from a normal dictionary are documented below.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dictionary : dict</span>
<span class="sd">        Must only contain keys which can be parsed into an :ref:`IsopyString &lt;isopystring&gt;` that hold a single value</span>
<span class="sd">        that can be converted to a float point value.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; ReferenceDict({&#39;Pd108&#39;: 108, &#39;105Pd&#39;: 105, &#39;pd&#39;: 46}).keys()</span>
<span class="sd">    dict_keys([&#39;108Pd&#39;, &#39;105Pd&#39;, &#39;Pd&#39;])</span>
<span class="sd">    &gt;&gt;&gt; ReferenceDict({&#39;Pd108&#39;: 108, &#39;105Pd&#39;: 105, &#39;pd&#39;: 46}).values()</span>
<span class="sd">    dict_values([array(108.), array(105.), array(46.)])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictionary</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dictionary</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dictionary</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Reference dict can only be initialised with another dict&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">key</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">StringParseError</span><span class="p">:</span> <span class="k">pass</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f8&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ReferenceDict can only store a single value per entry&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">(())</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">StringParseError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<div class="viewcode-block" id="ReferenceDict.get"><a class="viewcode-back" href="../../refpages/Dicts/isopy.ReferenceDict.html#isopy.ReferenceDict.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the value for *key* if key is in the dictionary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : :ref:`IsopyString &lt;isopystring&gt;`, :ref:`IsopyList &lt;isopylist&gt;`</span>
<span class="sd">            The values, or values, to return. If *key* is not in the dictionary it will return</span>
<span class="sd">            the *default* value for :class:`MassString`, :class:`ElementString` and :class:`IsotopeString` keys.</span>
<span class="sd">            For :class:`RatioString` keys not in the dictionary it will return the :func:`RatioString.numerator` key value</span>
<span class="sd">            divided by the :func:`RatioString.denominator` key value if both are present in the dictionary, otherwise</span>
<span class="sd">            it will return the *default* value.</span>
<span class="sd">        default : optional</span>
<span class="sd">            If not given the *default* value is np.nan.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float, :ref:`IsopyArray &lt;isopyarrays&gt;`</span>
<span class="sd">            If *key* is an :ref:`IsopyString &lt;isopystring&gt;` then a single float is returned. If</span>
<span class="sd">            :ref:`IsopyList &lt;isopylist&gt;` then an :ref:`IsopyArray &lt;isopyarrays&gt;` is returned.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; reference = ReferenceDict({&#39;108Pd&#39;: 100, &#39;105Pd&#39;: 20, &#39;104Pd&#39;: 150, &#39;104Pd/105Pd&#39;: 10})</span>
<span class="sd">        &gt;&gt;&gt; reference.get(&#39;108Pd/105Pd&#39;)</span>
<span class="sd">        5.0</span>
<span class="sd">        &gt;&gt;&gt; reference.get(&#39;104Pd/105Pd&#39;)</span>
<span class="sd">        10.0</span>
<span class="sd">        &gt;&gt;&gt; reference.get(&#39;104Pd&#39;) / reference.get(&#39;105Pd&#39;)</span>
<span class="sd">        7.5</span>
<span class="sd">        &gt;&gt;&gt; reference.get(&#39;102Pd&#39;)</span>
<span class="sd">        nan</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">StringParseError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">aslist</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">StringParseError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;parameter &quot;key&quot;: unable to parse </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> into an IsopyString or an IsopyList&#39;</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">RatioString</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span> <span class="o">/</span> \
                           <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span> <span class="k">pass</span>

            <span class="k">return</span> <span class="n">default</span></div>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iterable</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;other must be a dict&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">iterable</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">iterable</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setdefault</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<div class="viewcode-block" id="ReferenceDict.mass_keys"><a class="viewcode-back" href="../../refpages/Dicts/isopy.ReferenceDict.html#isopy.ReferenceDict.mass_keys">[docs]</a>    <span class="k">def</span> <span class="nf">mass_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">mass_number_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :class:`MassList` with all the :class:`MassString` keys in the dict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **mass_number_kwargs</span>
<span class="sd">            If given only the keys satisfying these keywords will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">MassList</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">MassString</span><span class="p">)])</span>
        <span class="k">if</span> <span class="n">mass_number_kwargs</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="o">**</span><span class="n">mass_number_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="ReferenceDict.element_keys"><a class="viewcode-back" href="../../refpages/Dicts/isopy.ReferenceDict.html#isopy.ReferenceDict.element_keys">[docs]</a>    <span class="k">def</span> <span class="nf">element_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">element_symbol_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :class:`ElementList` with all the :class:`ElementString` keys in the dict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **element_symbol_kwargs</span>
<span class="sd">            If given only the keys satisfying these keywords will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">ElementList</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">ElementString</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">element_symbol_kwargs</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="o">**</span><span class="n">element_symbol_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="ReferenceDict.isotope_keys"><a class="viewcode-back" href="../../refpages/Dicts/isopy.ReferenceDict.html#isopy.ReferenceDict.isotope_keys">[docs]</a>    <span class="k">def</span> <span class="nf">isotope_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">isotope_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :class:`IsotopeList` with all the :class:`IsotopeString` keys in the dict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **isotope_kwargs</span>
<span class="sd">            If given only the keys satisfying these keywords will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">IsotopeList</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">IsotopeString</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">isotope_kwargs</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="o">**</span><span class="n">isotope_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="ReferenceDict.ratio_keys"><a class="viewcode-back" href="../../refpages/Dicts/isopy.ReferenceDict.html#isopy.ReferenceDict.ratio_keys">[docs]</a>    <span class="k">def</span> <span class="nf">ratio_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">ratio_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :class:`RatioList` with all the :class:`RatioString` keys in the dict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **ratio_kwargs</span>
<span class="sd">            If given only the keys satisfying these keywords will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">RatioList</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">RatioString</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">ratio_kwargs</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="o">**</span><span class="n">ratio_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="ReferenceDict.copy"><a class="viewcode-back" href="../../refpages/Dicts/isopy.ReferenceDict.html#isopy.ReferenceDict.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ReferenceDict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<span class="c1">#############</span>
<span class="c1">### Array ###</span>
<span class="c1">#############</span>
<span class="k">def</span> <span class="nf">check_unsupported_parameters</span><span class="p">(</span><span class="n">func_name</span><span class="p">,</span> <span class="n">unsupported_param</span><span class="p">,</span> <span class="n">given_param</span><span class="p">):</span>
    <span class="n">unsupported_used</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">param</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">unsupported_param</span> <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">given_param</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unsupported_used</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Use of &quot;</span><span class="si">{}</span><span class="s1">&quot; parameter(s) is currently not supported for &quot;</span><span class="si">{}</span><span class="s1">&quot; with isopy arrays&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">unsupported_used</span><span class="p">,</span> <span class="n">func_name</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">input_array_ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is for 0 or 1 dim arrays where the stored value is the same for each key</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_array</span> <span class="o">=</span> <span class="n">array</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default_value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_array</span>


<span class="k">class</span> <span class="nc">IsopyArray</span><span class="p">(</span><span class="n">IsopyType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">):</span>
        <span class="n">sdict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">sdict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">])]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">sdict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span>

        <span class="n">flen</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">flen</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sdict</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">flen</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span> <span class="n">flen</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;{:&lt;</span><span class="si">{}</span><span class="s1">}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">flen</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()]),</span>
                                   <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;{:&lt;</span><span class="si">{}</span><span class="s1">}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sdict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">flen</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
                                             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">(</span><span class="si">{}</span><span class="s1">, dtype=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()])),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">([</span><span class="si">{}</span><span class="s1">], dtype=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">_warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;please use isopy.array instead&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__array_ufunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#TODO make out before which should save some time</span>
        <span class="n">default_value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;default_value&#39;</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ufunc</span> <span class="ow">in</span> <span class="p">[</span><span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">cos</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">arccos</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">arctan</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">degrees</span><span class="p">,</span>
                                          <span class="n">_np</span><span class="o">.</span><span class="n">radians</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">sinh</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">cosh</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">tanh</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">arccosh</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">arctanh</span><span class="p">,</span>
                                          <span class="n">_np</span><span class="o">.</span><span class="n">rint</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">floor</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">ceil</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">trunc</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">expm1</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">exp2</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">log10</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">log2</span><span class="p">,</span>
                                          <span class="n">_np</span><span class="o">.</span><span class="n">log1p</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">positive</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">negative</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">cbrt</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">square</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">fabs</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">sign</span><span class="p">,</span>
                                          <span class="n">_np</span><span class="o">.</span><span class="n">absolute</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">abs</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">isnan</span><span class="p">]:</span> <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ufunc</span> <span class="ow">in</span> <span class="p">[</span><span class="n">_np</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">multiply</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">divide</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">subtract</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">true_divide</span><span class="p">,</span>
                                            <span class="n">_np</span><span class="o">.</span><span class="n">true_divide</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">float_power</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">fmod</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">mod</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">remainder</span><span class="p">,</span>
                                            <span class="n">_np</span><span class="o">.</span><span class="n">greater</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">less</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">greater_equal</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">less_equal</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">equal</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">not_equal</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">maximum</span><span class="p">,</span>
                                            <span class="n">_np</span><span class="o">.</span><span class="n">minimum</span><span class="p">]:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Function &quot;</span><span class="si">{}</span><span class="s1">&quot; is not supported by isopy arrays&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ufunc</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s1">&#39;__call__&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;method &quot;</span><span class="si">{}</span><span class="s1">&quot; is currently not supported&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>
        <span class="n">check_unsupported_parameters</span><span class="p">(</span><span class="n">ufunc</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="s1">&#39;where&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="s1">&#39;casting&#39;</span><span class="p">,</span> <span class="s1">&#39;order&#39;</span><span class="p">,</span> <span class="s1">&#39;subok&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;signature&#39;</span><span class="p">,</span> <span class="s1">&#39;extobj&#39;</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;copy&#39;</span><span class="p">],</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">is_input_isopy</span> <span class="o">=</span> <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">IsopyArray</span><span class="p">)</span> <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">is_input_isopy</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">|</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">is_input_isopy</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

            <span class="n">isopy_i</span> <span class="o">=</span> <span class="n">is_input_isopy</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="n">isopy_i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">other_i</span> <span class="o">=</span> <span class="n">is_input_isopy</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c1">#Are used as is</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="n">other_i</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">other</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="n">other_i</span><span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Failed to convert input &quot;</span><span class="si">{}</span><span class="s1">&quot; to compatible array&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="n">other_i</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;input &quot;</span><span class="si">{}</span><span class="s1">&quot; has to many dimensions&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="n">other_i</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;structured ndarrays are currently not supported as inputs&#39;</span><span class="p">)</span>

                    <span class="n">inputs</span><span class="p">[</span><span class="n">other_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_array_ndarray</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="n">other_i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;At least one input must be an isopy array&#39;</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ufunc</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">inp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Key &quot;</span><span class="si">{}</span><span class="s1">&quot; not found in all inputs&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_array</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__array_function__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="n">default_value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;default_value&#39;</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">func</span> <span class="ow">in</span> <span class="p">[</span><span class="n">_np</span><span class="o">.</span><span class="n">prod</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nanprod</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nansum</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">cumprod</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nancumprod</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nancumsum</span><span class="p">,</span>
                    <span class="n">_np</span><span class="o">.</span><span class="n">amin</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">amax</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">fix</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">ptp</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">percentile</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">quantile</span><span class="p">,</span>
                    <span class="n">_np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">average</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">var</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">,</span>
                    <span class="n">_np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nanvar</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">,</span> <span class="n">_npf</span><span class="o">.</span><span class="n">mad</span><span class="p">,</span> <span class="n">_npf</span><span class="o">.</span><span class="n">nanmad</span><span class="p">,</span> <span class="n">_npf</span><span class="o">.</span><span class="n">se</span><span class="p">,</span> <span class="n">_npf</span><span class="o">.</span><span class="n">nanse</span><span class="p">,</span> <span class="n">_npf</span><span class="o">.</span><span class="n">sd</span><span class="p">,</span> <span class="n">_npf</span><span class="o">.</span><span class="n">nansd</span><span class="p">,</span>
                    <span class="n">_np</span><span class="o">.</span><span class="n">any</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">all</span><span class="p">]:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="n">bind</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">func_parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">parsed_kwargs</span> <span class="o">=</span> <span class="n">bind</span><span class="o">.</span><span class="n">arguments</span>
            <span class="n">check_unsupported_parameters</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="s1">&#39;where&#39;</span><span class="p">,</span> <span class="s1">&#39;overwrite_input&#39;</span><span class="p">],</span> <span class="n">parsed_kwargs</span><span class="p">)</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">func_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">IsopyArray</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Array must be an isopy array&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">&gt;</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_np</span><span class="o">.</span><span class="n">AxisError</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_array</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default_value</span><span class="p">),</span> <span class="o">**</span><span class="n">parsed_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">keys</span><span class="p">()})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">array</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">keys</span><span class="p">()]),</span>
                            <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="o">**</span><span class="n">parsed_kwargs</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">func</span> <span class="ow">in</span> <span class="p">[</span><span class="n">_np</span><span class="o">.</span><span class="n">argmax</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">argmin</span><span class="p">]:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="n">bind</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">func_parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">parsed_kwargs</span> <span class="o">=</span> <span class="n">bind</span><span class="o">.</span><span class="n">arguments</span>
            <span class="n">check_unsupported_parameters</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="s1">&#39;where&#39;</span><span class="p">,</span> <span class="s1">&#39;overwrite_input&#39;</span><span class="p">],</span> <span class="n">parsed_kwargs</span><span class="p">)</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">func_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">IsopyArray</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Array must be an isopy array&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">&gt;</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_np</span><span class="o">.</span><span class="n">AxisError</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="n">_np</span><span class="o">.</span><span class="n">argmax</span><span class="p">:</span> <span class="n">step1</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">step1</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">array</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="nb">int</span><span class="p">(</span><span class="n">func</span><span class="p">([</span><span class="n">step1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">step1</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span> <span class="o">**</span><span class="n">parsed_kwargs</span><span class="p">))]</span>
            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_array</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default_value</span><span class="p">),</span> <span class="o">**</span><span class="n">parsed_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">keys</span><span class="p">()})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">array</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">keys</span><span class="p">()]),</span>
                            <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="o">**</span><span class="n">parsed_kwargs</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">func</span> <span class="ow">in</span> <span class="p">[</span><span class="n">_np</span><span class="o">.</span><span class="n">around</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">round</span><span class="p">]:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="n">bind</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">parsed_kwargs</span> <span class="o">=</span> <span class="n">bind</span><span class="o">.</span><span class="n">arguments</span>
            <span class="n">check_unsupported_parameters</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">],</span> <span class="n">parsed_kwargs</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">IsopyArray</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Array must be an isopy array&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_array</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default_value</span><span class="p">),</span> <span class="o">**</span><span class="n">parsed_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">keys</span><span class="p">()})</span>

        <span class="k">elif</span> <span class="n">func</span> <span class="ow">is</span> <span class="n">_np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">Signature</span><span class="p">([</span><span class="n">_inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;arr&#39;</span><span class="p">,</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_ONLY</span><span class="p">),</span>
                                      <span class="n">_inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                                      <span class="n">_inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)])</span>
            <span class="n">bind</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">func_parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">parsed_kwargs</span> <span class="o">=</span> <span class="n">bind</span><span class="o">.</span><span class="n">arguments</span>
            <span class="n">check_unsupported_parameters</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">],</span> <span class="n">parsed_kwargs</span><span class="p">)</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">func_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">IsopyArray</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">False</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]:</span>
                <span class="c1">#Fails if one is void</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;All arrays must be Isopy Arrays of the same type&#39;</span><span class="p">)</span>


            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">keys</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">skip_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">asarray</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">func</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">})</span>
            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="kc">False</span> <span class="ow">in</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All arrays must have the same size&#39;</span><span class="p">)</span>
                <span class="n">ndim</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>

                <span class="n">keys</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">keys</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">arrd</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">:</span> <span class="n">arrd</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">keys</span><span class="p">()})</span>

                <span class="k">return</span> <span class="n">asarray</span><span class="p">(</span><span class="n">arrd</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">ndim</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_np</span><span class="o">.</span><span class="n">AxisError</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">func</span> <span class="ow">is</span> <span class="n">_np</span><span class="o">.</span><span class="n">append</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="n">bind</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">parsed_kwargs</span> <span class="o">=</span> <span class="n">bind</span><span class="o">.</span><span class="n">arguments</span>
            <span class="n">array1</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;arr&#39;</span><span class="p">)</span>
            <span class="n">array2</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">)</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">parsed_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">array1</span><span class="p">,</span> <span class="n">array2</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The use of </span><span class="si">{}</span><span class="s1"> is not supported by isopy arrays&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">numerictypes</span><span class="o">.</span><span class="n">void</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_void</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ndarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy_to_clipboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copy the content of the array to the clipboard.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        delimiter: str, optional</span>
<span class="sd">            The delimiter for columns in the data. Default is ``&#39;, &#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_pyperclip</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="n">delimiter</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ncols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nrows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">default</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">default</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">default</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
                <span class="n">out</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">default</span>
                <span class="k">return</span> <span class="n">out</span>
            <span class="k">elif</span> <span class="n">default</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">:</span> <span class="c1">#default.shape?</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;default_value must be zero-dimensional or the same size as the array&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">default</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


<div class="viewcode-block" id="MassArray"><a class="viewcode-back" href="../../refpages/Arrays/isopy.MassArray.html#isopy.MassArray">[docs]</a><span class="k">class</span> <span class="nc">MassArray</span><span class="p">(</span><span class="n">IsopyArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An array where data is stored in rows and columns with :class:`Masstring` keys.</span>

<span class="sd">    See the tutorial :ref:`working with arrays` for a description of the functionality these arrays.</span>

<span class="sd">    This is a custom subclass of a `structured numpy array &lt;https://docs.scipy.org/doc/numpy/user/basics.rec.html&gt;`</span>
<span class="sd">    and therefore contains all the methods and attributes that a normal numpy ndarray does. However, these</span>
<span class="sd">    may **not** work as expected and caution is advised when using attributes/methods not described below or in the</span>
<span class="sd">    tutorial.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : int, dict, list, ndarray, :ref:`IsopyArray &lt;isopyarray&gt;`</span>
<span class="sd">        * If *values* is an integer then an array of size *values* will be created where every value is ``0``. Requires</span>
<span class="sd">          the *keys* keyword.</span>

<span class="sd">        * If *values* is a dict each item in the dict will be a column in the array. The key of the item will be used</span>
<span class="sd">          as the key of the column. The the size of each item in the dict all have the same size.</span>

<span class="sd">        * If *values* is a one dimensional list or ndarray then the size of the list must have the same as the *keys*.</span>

<span class="sd">        * If *values* is a two dimensional list or ndarray then the second dimension must have the same size as *keys*.</span>

<span class="sd">        * If *values* is is an structured numpy array and *keys* is not given then the ``dtype.names`` will be used</span>
<span class="sd">          as keys. If *keys* is given then the the size of *keys* must be the same as ``dtype.names``.</span>

<span class="sd">        * If *values* is an :class:`MassArray` and *keys* is not given then a copy of the array is returned.</span>

<span class="sd">        * If *values* is an :ref:`IsopyArray &lt;isopyarray&gt;` and *keys* is given then a copy of the array with the new</span>
<span class="sd">          keys will be returned.</span>

<span class="sd">    keys : list of str, optional</span>
<span class="sd">        A list of the columns keys of the array. Does not have to be given the column keys can be inferred from *values*.</span>
<span class="sd">    ndim : {-1, 0, 1}, optional</span>
<span class="sd">        The number of dimensions the array should have. If -1 then it will make a zero dimensional array if possible</span>
<span class="sd">        otherwise it will make a one dimensional array. If not given *ndim* is inferred from *values*. Will raise</span>
<span class="sd">        ValueError is array cannot be made with the specified dimensions.</span>
<span class="sd">    dtype : numpy.dtype</span>
<span class="sd">        Can be any type accepted by numpy. All columns in the array will have the same dtype. For *values* that are</span>
<span class="sd">        not numpy.ndarray object the default value is ``np.float``. For numpy.ndarray objects the default value is</span>
<span class="sd">        inferred from the object. If *values* contains more than one dtype a common dtype will be used.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    ncolumns : int</span>
<span class="sd">        The number of columns in the array.</span>
<span class="sd">    nrows : int</span>
<span class="sd">        The number of rows in the array. If the array is zero-dimensional ``-1`` is returned.</span>
<span class="sd">    size : int</span>
<span class="sd">        The size of the array. Same as ``abs(array.nrows)``.</span>
<span class="sd">    ndim : {0, 1}</span>
<span class="sd">        The number of dimensions the array has.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; print(MassArray(2, keys=[&#39;99&#39;, &#39;105&#39;, 111]))</span>
<span class="sd">    99  , 105  , 111</span>
<span class="sd">    0.0 , 0.0 , 0.0</span>
<span class="sd">    0.0 , 0.0 , 0.0</span>
<span class="sd">    &gt;&gt;&gt; print(MassArray([[1, 2, 3], [4, 5, 6]], keys=[&#39;99&#39;, &#39;105&#39;, 111]))</span>
<span class="sd">    99  , 105  , 111</span>
<span class="sd">    1   , 2   , 3</span>
<span class="sd">    4   , 5   , 6</span>
<span class="sd">    &gt;&gt;&gt; print(MassArray({&#39;99&#39;: [1, 2], &#39;105&#39;: [2, 5], 111: [3, 6]}, dtype=np.float64))</span>
<span class="sd">    99  , 105  , 111</span>
<span class="sd">    1.0 , 2.0 , 3.0</span>
<span class="sd">    2.0 , 5.0 , 6.0</span>

<span class="sd">    For more examples see the tutorial :ref:`working with arrays`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MassNdarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<div class="viewcode-block" id="MassArray.copy"><a class="viewcode-back" href="../../refpages/Arrays/isopy.MassArray.html#isopy.MassArray.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">mass_number_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of the array.</span>

<span class="sd">        If keyword arguments are given then only the columns with keys that satisfy these arguments is copied.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **mass_number_kwargs</span>
<span class="sd">            See :func:`MassList.copy` for a description of the avaliable keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mass_number_kwargs</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="o">**</span><span class="n">mass_number_kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MassArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MassArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

<div class="viewcode-block" id="MassArray.keys"><a class="viewcode-back" href="../../refpages/Arrays/isopy.MassArray.html#isopy.MassArray.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :class:`MassList` containing the keys in the array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MassArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

<div class="viewcode-block" id="MassArray.get"><a class="viewcode-back" href="../../refpages/Arrays/isopy.MassArray.html#isopy.MassArray.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the data for column *key*. If absent then an array consisting of the *default* value with</span>
<span class="sd">        the same size as the current array is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : :class:`MassString`</span>
<span class="sd">            The key of the column to be returned.</span>
<span class="sd">        default</span>
<span class="sd">            Must either be an zero-dimensional value or a array of values the same size as the array.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if the size of *default* is not the same as the array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">            The data for column *key*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MassArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>

<div class="viewcode-block" id="MassArray.ratio"><a class="viewcode-back" href="../../refpages/Arrays/isopy.MassArray.html#isopy.MassArray.ratio">[docs]</a>    <span class="k">def</span> <span class="nf">ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denominator</span><span class="p">,</span> <span class="n">remove_denominator</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Divide all values in the array by the *denominator* column and return a :class:`RatioArray`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        denominator: str</span>
<span class="sd">            The denominator column.</span>
<span class="sd">        remove_denominator : bool</span>
<span class="sd">            If ``True`` then column with *denominator* as the numerator is not included in the returned array. Default</span>
<span class="sd">            value is ``False``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">RatioArray</span><span class="p">(</span><span class="bp">self</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="n">denominator</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">/</span><span class="n">denominator</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_denominator</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">numerator_isotope_not</span> <span class="o">=</span> <span class="n">denominator</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span></div></div>


<div class="viewcode-block" id="ElementArray"><a class="viewcode-back" href="../../refpages/Arrays/isopy.ElementArray.html#isopy.ElementArray">[docs]</a><span class="k">class</span> <span class="nc">ElementArray</span><span class="p">(</span><span class="n">IsopyArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An array where data is stored in rows and columns with :class:`ElementString` keys.</span>

<span class="sd">    See the tutorial :ref:`working with arrays` for a description of the functionality these arrays.</span>

<span class="sd">    This is a custom subclass of a `structured numpy array &lt;https://docs.scipy.org/doc/numpy/user/basics.rec.html&gt;`</span>
<span class="sd">    and therefore contains all the methods and attributes that a normal numpy ndarray does. However, these</span>
<span class="sd">    may **not** work as expected and caution is advised when using attributes/methods not described below or in the</span>
<span class="sd">    tutorial.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : int, dict, list, ndarray, :ref:`IsopyArray &lt;isopyarray&gt;`</span>
<span class="sd">        * If *values* is an integer then an array of size *values* will be created where every value is ``0``. Requires</span>
<span class="sd">          the *keys* keyword.</span>

<span class="sd">        * If *values* is a dict each item in the dict will be a column in the array. The key of the item will be used</span>
<span class="sd">          as the key of the column. The the size of each item in the dict all have the same size.</span>

<span class="sd">        * If *values* is a one dimensional list or ndarray then the size of the list must have the same as the *keys*.</span>

<span class="sd">        * If *values* is a two dimensional list or ndarray then the second dimension must have the same size as *keys*.</span>

<span class="sd">        * If *values* is is an structured numpy array and *keys* is not given then the ``dtype.names`` will be used</span>
<span class="sd">          as keys. If *keys* is given then the the size of *keys* must be the same as ``dtype.names``.</span>

<span class="sd">        * If *values* is an :class:`ElementArray` and *keys* is not given then a copy of the array is returned.</span>

<span class="sd">        * If *values* is an :ref:`IsopyArray &lt;isopyarray&gt;` and *keys* is given then a copy of the array with the new</span>
<span class="sd">          keys will be returned.</span>

<span class="sd">    keys : list of str, optional</span>
<span class="sd">        A list of the columns keys of the array. Does not have to be given the column keys can be inferred from *values*.</span>
<span class="sd">    ndim : {-1, 0, 1}, optional</span>
<span class="sd">        The number of dimensions the array should have. If -1 then it will make a zero dimensional array if possible</span>
<span class="sd">        otherwise it will make a one dimensional array. If not given *ndim* is inferred from *values*. Will raise</span>
<span class="sd">        ValueError is array cannot be made with the specified dimensions.</span>
<span class="sd">    dtype : numpy.dtype</span>
<span class="sd">        Can be any type accepted by numpy. All columns in the array will have the same dtype. For *values* that are</span>
<span class="sd">        not numpy.ndarray object the default value is ``np.float``. For numpy.ndarray objects the default value is</span>
<span class="sd">        inferred from the object. If *values* contains more than one dtype a common dtype will be used.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    ncolumns : int</span>
<span class="sd">        The number of columns in the array.</span>
<span class="sd">    nrows : int</span>
<span class="sd">        The number of rows in the array. If the array is zero-dimensional ``-1`` is returned.</span>
<span class="sd">    size : int</span>
<span class="sd">        The size of the array. Same as ``abs(array.nrows)``.</span>
<span class="sd">    ndim : {0, 1}</span>
<span class="sd">        The number of dimensions the array has.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; print(ElementArray(2, keys=[&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]))</span>
<span class="sd">    Ru  , Pd  , Cd</span>
<span class="sd">    0.0 , 0.0 , 0.0</span>
<span class="sd">    0.0 , 0.0 , 0.0</span>
<span class="sd">    &gt;&gt;&gt; print(ElementArray([[1, 2, 3], [4, 5, 6]], keys=[&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;]))</span>
<span class="sd">    Ru  , Pd  , Cd</span>
<span class="sd">    1   , 2   , 3</span>
<span class="sd">    4   , 5   , 6</span>
<span class="sd">    &gt;&gt;&gt; print(ElementArray({&#39;ru&#39;: [1, 2], &#39;pd&#39;: [2, 5], &#39;cd&#39;: [3, 6]}, dtype=np.float64))</span>
<span class="sd">    Ru  , Pd  , Cd</span>
<span class="sd">    1.0 , 2.0 , 3.0</span>
<span class="sd">    2.0 , 5.0 , 6.0</span>

<span class="sd">    For more examples see the tutorial :ref:`working with arrays`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ElementNdarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<div class="viewcode-block" id="ElementArray.copy"><a class="viewcode-back" href="../../refpages/Arrays/isopy.ElementArray.html#isopy.ElementArray.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">element_symbol_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of the array.</span>

<span class="sd">        If keyword arguments are given then only the columns with keys that satisfy these arguments is copied.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **element_symbol_kwargs</span>
<span class="sd">            See :func:`ElementList.copy` for a description of the avaliable keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">element_symbol_kwargs</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="o">**</span><span class="n">element_symbol_kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ElementArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ElementArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

<div class="viewcode-block" id="ElementArray.keys"><a class="viewcode-back" href="../../refpages/Arrays/isopy.ElementArray.html#isopy.ElementArray.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :class:`ElementList` containing the key for each column in the array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ElementArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

<div class="viewcode-block" id="ElementArray.get"><a class="viewcode-back" href="../../refpages/Arrays/isopy.ElementArray.html#isopy.ElementArray.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the data for column *key*. If absent then an array consisting of the *default* value with</span>
<span class="sd">        the same size as the current array is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : :class:`ElementString`</span>
<span class="sd">            The key of the column to be returned.</span>
<span class="sd">        default</span>
<span class="sd">            Must either be an zero-dimensional value or a array of values the same size as the array.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if the size of *default* is not the same as the array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">            The data for column *key*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ElementArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>

<div class="viewcode-block" id="ElementArray.ratio"><a class="viewcode-back" href="../../refpages/Arrays/isopy.ElementArray.html#isopy.ElementArray.ratio">[docs]</a>    <span class="k">def</span> <span class="nf">ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denominator</span><span class="p">,</span> <span class="n">remove_denominator</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Divide all values in the array by the *denominator* column and return a :class:`RatioArray`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        denominator: str</span>
<span class="sd">            The denominator column.</span>
<span class="sd">        remove_denominator : bool</span>
<span class="sd">            If ``True`` then column with *denominator* as the numerator is not included in the returned array. Default</span>
<span class="sd">            value is ``False``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">RatioArray</span><span class="p">(</span><span class="bp">self</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="n">denominator</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">/</span><span class="n">denominator</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_denominator</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">numerator_isotope_not</span> <span class="o">=</span> <span class="n">denominator</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span></div></div>


<div class="viewcode-block" id="IsotopeArray"><a class="viewcode-back" href="../../refpages/Arrays/isopy.IsotopeArray.html#isopy.IsotopeArray">[docs]</a><span class="k">class</span> <span class="nc">IsotopeArray</span><span class="p">(</span><span class="n">IsopyArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An array where data is stored in rows and columns with :class:`IsotopeString` keys.</span>

<span class="sd">    See the tutorial :ref:`working with arrays` for a description of the functionality these arrays.</span>

<span class="sd">    This is a custom subclass of a `structured numpy array &lt;https://docs.scipy.org/doc/numpy/user/basics.rec.html&gt;`</span>
<span class="sd">    and therefore contains all the methods and attributes that a normal numpy ndarray does. However, these</span>
<span class="sd">    may **not** work as expected and caution is advised when using attributes/methods not described below or in the</span>
<span class="sd">    tutorial.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : int, dict, list, ndarray, :ref:`IsopyArray &lt;isopyarray&gt;`</span>
<span class="sd">        * If *values* is an integer then an array of size *values* will be created where every value is ``0``. Requires</span>
<span class="sd">          the *keys* keyword.</span>

<span class="sd">        * If *values* is a dict each item in the dict will be a column in the array. The key of the item will be used</span>
<span class="sd">          as the key of the column. The the size of each item in the dict all have the same size.</span>

<span class="sd">        * If *values* is a one dimensional list or ndarray then the size of the list must have the same as the *keys*.</span>

<span class="sd">        * If *values* is a two dimensional list or ndarray then the second dimension must have the same size as *keys*.</span>

<span class="sd">        * If *values* is is an structured numpy array and *keys* is not given then the ``dtype.names`` will be used</span>
<span class="sd">          as keys. If *keys* is given then the the size of *keys* must be the same as ``dtype.names``.</span>

<span class="sd">        * If *values* is an :class:`IsotopeArray` and *keys* is not given then a copy of the array is returned.</span>

<span class="sd">        * If *values* is an :ref:`IsopyArray &lt;isopyarray&gt;` and *keys* is given then a copy of the array with the new</span>
<span class="sd">          keys will be returned.</span>

<span class="sd">    keys : list of str, optional</span>
<span class="sd">        A list of the columns keys of the array. Does not have to be given the column keys can be inferred from *values*.</span>
<span class="sd">    ndim : {-1, 0, 1}, optional</span>
<span class="sd">        The number of dimensions the array should have. If -1 then it will make a zero dimensional array if possible</span>
<span class="sd">        otherwise it will make a one dimensional array. If not given *ndim* is inferred from *values*. Will raise</span>
<span class="sd">        ValueError is array cannot be made with the specified dimensions.</span>
<span class="sd">    dtype : numpy.dtype</span>
<span class="sd">        Can be any type accepted by numpy. All columns in the array will have the same dtype. For *values* that are</span>
<span class="sd">        not numpy.ndarray object the default value is ``np.float``. For numpy.ndarray objects the default value is</span>
<span class="sd">        inferred from the object. If *values* contains more than one dtype a common dtype will be used.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    ncolumns : int</span>
<span class="sd">        The number of columns in the array.</span>
<span class="sd">    nrows : int</span>
<span class="sd">        The number of rows in the array. If the array is zero-dimensional ``-1`` is returned.</span>
<span class="sd">    size : int</span>
<span class="sd">        The size of the array. Same as ``abs(array.nrows)``.</span>
<span class="sd">    ndim : {0, 1}</span>
<span class="sd">        The number of dimensions the array has.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; print(IsotopeArray(2, keys=[&#39;ru99&#39;, &#39;pd105&#39;, &#39;cd111&#39;]))</span>
<span class="sd">    99Ru  , 105Pd  , 111Cd</span>
<span class="sd">    0.0   , 0.0    , 0.0</span>
<span class="sd">    0.0   , 0.0    , 0.0</span>
<span class="sd">    &gt;&gt;&gt; print(IsotopeArray([[1, 2, 3], [4, 5, 6]], keys=[&#39;ru99&#39;, &#39;pd105&#39;, &#39;cd111&#39;]))</span>
<span class="sd">    99Ru  , 105Pd  , 111Cd</span>
<span class="sd">    1     , 2      , 3</span>
<span class="sd">    4     , 5      , 6</span>
<span class="sd">    &gt;&gt;&gt; print(IsotopeArray({&#39;ru99&#39;: [1, 2], &#39;pd105&#39;: [2, 5], &#39;cd111&#39;: [3, 6]}, dtype=np.float64))</span>
<span class="sd">    99Ru  , 105Pd  , 111Cd</span>
<span class="sd">    1.0   , 2.0    , 3.0</span>
<span class="sd">    2.0   , 5.0    , 6.0</span>

<span class="sd">    For more examples see the tutorial :ref:`working with arrays`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">IsotopeNdarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<div class="viewcode-block" id="IsotopeArray.copy"><a class="viewcode-back" href="../../refpages/Arrays/isopy.IsotopeArray.html#isopy.IsotopeArray.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">isotope_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of the array.</span>

<span class="sd">        If keyword arguments are given then only the columns with keys that satisfy these arguments is copied.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **isotope_kwargs</span>
<span class="sd">            See :func:`IsotopeList.copy` for a description of the avaliable keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">isotope_kwargs</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="o">**</span><span class="n">isotope_kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsotopeArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsotopeArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

<div class="viewcode-block" id="IsotopeArray.keys"><a class="viewcode-back" href="../../refpages/Arrays/isopy.IsotopeArray.html#isopy.IsotopeArray.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :class:`IsotopeList` containing the key for each column in the array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsotopeArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

<div class="viewcode-block" id="IsotopeArray.get"><a class="viewcode-back" href="../../refpages/Arrays/isopy.IsotopeArray.html#isopy.IsotopeArray.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the data for column *key*. If absent then an array consisting of the *default* value with</span>
<span class="sd">        the same size as the current array is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : :class:`IsotopeString`</span>
<span class="sd">            The key of the column to be returned.</span>
<span class="sd">        default</span>
<span class="sd">            Must either be an zero-dimensional value or a array of values the same size as the array.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if the size of *default* is not the same as the array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">            The data for column *key*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsotopeArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>

<div class="viewcode-block" id="IsotopeArray.ratio"><a class="viewcode-back" href="../../refpages/Arrays/isopy.IsotopeArray.html#isopy.IsotopeArray.ratio">[docs]</a>    <span class="k">def</span> <span class="nf">ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denominator</span><span class="p">,</span> <span class="n">remove_denominator</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Divide all values in the array by the *denominator* column and return a :class:`RatioArray`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        denominator: str</span>
<span class="sd">            The denominator column.</span>
<span class="sd">        remove_denominator : bool</span>
<span class="sd">            If ``True`` then column with *denominator* as the numerator is not included in the returned array. Default</span>
<span class="sd">            value is ``False``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">RatioArray</span><span class="p">(</span><span class="bp">self</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="n">denominator</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">/</span><span class="n">denominator</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_denominator</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">numerator_isotope_not</span> <span class="o">=</span> <span class="n">denominator</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span></div></div>


<div class="viewcode-block" id="RatioArray"><a class="viewcode-back" href="../../refpages/Arrays/isopy.RatioArray.html#isopy.RatioArray">[docs]</a><span class="k">class</span> <span class="nc">RatioArray</span><span class="p">(</span><span class="n">IsopyArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An array where data is stored in rows and columns with :class:`RatioString` keys.</span>

<span class="sd">    See the tutorial :ref:`working with arrays` for a description of the functionality these arrays.</span>

<span class="sd">    This is a custom subclass of a `structured numpy array &lt;https://docs.scipy.org/doc/numpy/user/basics.rec.html&gt;`</span>
<span class="sd">    and therefore contains all the methods and attributes that a normal numpy ndarray does. However, these</span>
<span class="sd">    may **not** work as expected and caution is advised when using attributes/methods not described below or in the</span>
<span class="sd">    tutorial.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : int, dict, list, ndarray, :ref:`IsopyArray &lt;isopyarray&gt;`</span>
<span class="sd">        * If *values* is an integer then an array of size *values* will be created with every value set to 0. Requires</span>
<span class="sd">          the *keys* keyword.</span>

<span class="sd">        * If *values* is a dict each item in the dict will be a column in the array. The key of the item will be used</span>
<span class="sd">          as the key of the column. The the size of each item in the dict all have the same size.</span>

<span class="sd">        * If *values* is a one dimensional list or ndarray then the size of the list must have the same as the *keys*.</span>

<span class="sd">        * If *values* is a two dimensional list or ndarray then the second dimension must have the same size as *keys*.</span>

<span class="sd">        * If *values* is is an structured numpy array and *keys* is not given then the ``dtype.names`` will be used</span>
<span class="sd">          as keys. If *keys* is given then the the size of *keys* must be the same as ``dtype.names``.</span>

<span class="sd">        * If *values* is an :class:`RatioArray` and *keys* is not given then a copy of the array is returned.</span>

<span class="sd">        * If *values* is an :ref:`IsopyArray &lt;isopyarray&gt;` and *keys* is given then a copy of the array with the new</span>
<span class="sd">          keys will be returned.</span>

<span class="sd">    keys : list of str, optional</span>
<span class="sd">        A list of the columns keys of the array. Does not have to be given the column keys can be inferred from *values*.</span>
<span class="sd">    ndim : {-1, 0, 1}, optional</span>
<span class="sd">        The number of dimensions the array should have. If -1 then it will make a zero dimensional array if possible</span>
<span class="sd">        otherwise it will make a one dimensional array. If not given *ndim* is inferred from *values*. Will raise</span>
<span class="sd">        ValueError is array cannot be made with the specified dimensions.</span>
<span class="sd">    dtype : numpy.dtype</span>
<span class="sd">        Can be any type accepted by numpy. All columns in the array will have the same dtype. For *values* that are</span>
<span class="sd">        not numpy.ndarray object the default value is ``np.float``. For numpy.ndarray objects the default value is</span>
<span class="sd">        inferred from the object. If *values* contains more than one dtype a common dtype will be used.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    ncolumns : int</span>
<span class="sd">        The number of columns in the array.</span>
<span class="sd">    nrows : int</span>
<span class="sd">        The number of rows in the array. If the array is zero-dimensional ``-1`` is returned.</span>
<span class="sd">    size : int</span>
<span class="sd">        The size of the array. Same as ``abs(array.nrows)``.</span>
<span class="sd">    ndim : {0, 1}</span>
<span class="sd">        The number of dimensions the array has.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; print(RatioArray(2, keys=[&#39;ru99/108Pd&#39;, &#39;pd105/108Pd&#39;, &#39;cd111/108Pd&#39;]))</span>
<span class="sd">    99Ru/108Pd , 105Pd/108Pd , 111Cd/108Pd</span>
<span class="sd">    0.0  , 0.0   , 0.0</span>
<span class="sd">    0.0  , 0.0   , 0.0</span>
<span class="sd">    &gt;&gt;&gt; print(RatioArray([[1, 2, 3], [4, 5, 6]], keys=[&#39;ru99/108Pd&#39;, &#39;pd105/108Pd&#39;, &#39;cd111/108Pd&#39;]))</span>
<span class="sd">    99Ru/108Pd , 105Pd/108Pd , 111Cd/108Pd</span>
<span class="sd">    1          , 2           , 3</span>
<span class="sd">    4          , 5           , 6</span>
<span class="sd">    &gt;&gt;&gt; print(RatioArray({&#39;ru99/108Pd&#39;: [1, 2], &#39;pd105/108Pd&#39;: [2, 5], &#39;cd111/108Pd&#39;: [3, 6]}, dtype=np.float64))</span>
<span class="sd">    99Ru/108Pd  , 105Pd/108Pd  , 111Cd/108Pd</span>
<span class="sd">    1.0         , 2.0          , 3.0</span>
<span class="sd">    2.0         , 5.0          , 6.0</span>

<span class="sd">    For more examples see the tutorial :ref:`working with arrays`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RatioNdarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<div class="viewcode-block" id="RatioArray.copy"><a class="viewcode-back" href="../../refpages/Arrays/isopy.RatioArray.html#isopy.RatioArray.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">ratio_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of the array.</span>

<span class="sd">        If keyword arguments are given then only the columns with keys that satisfy these arguments is copied.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **ratio_kwargs</span>
<span class="sd">            See :func:`RatioList.copy` for a description of the avaliable keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ratio_kwargs</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="o">**</span><span class="n">ratio_kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RatioArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RatioArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

<div class="viewcode-block" id="RatioArray.keys"><a class="viewcode-back" href="../../refpages/Arrays/isopy.RatioArray.html#isopy.RatioArray.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :class:`RatioList` containing the key for each column in the array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RatioArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

<div class="viewcode-block" id="RatioArray.get"><a class="viewcode-back" href="../../refpages/Arrays/isopy.RatioArray.html#isopy.RatioArray.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the data for column *key*. If absent then an array consisting of the *default* value with</span>
<span class="sd">        the same size as the current array is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : :class:`RatioString`</span>
<span class="sd">            The key of the column to be returned.</span>
<span class="sd">        default</span>
<span class="sd">            Must either be an zero-dimensional value or a array of values the same size as the array.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if the size of *default* is not the same as the array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">            The data for column *key*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RatioArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>

<div class="viewcode-block" id="RatioArray.deratio"><a class="viewcode-back" href="../../refpages/Arrays/isopy.RatioArray.html#isopy.RatioArray.deratio">[docs]</a>    <span class="k">def</span> <span class="nf">deratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denominator_value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Multiply the array by the *denominator_value* and return with the ratio numerators as the new keys.</span>

<span class="sd">        The array must have a common denominator or an exception will be raised. the denominator will be included</span>
<span class="sd">        as a column key in the returned array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        denominator_value : float</span>
<span class="sd">            Default is ``1.0``</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#Must have a common denominator</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">get_common_denominator</span><span class="p">()</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">RatioArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">numerators</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">denominator</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">denominator</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span> <span class="o">*</span> <span class="n">denominator_value</span></div></div>


<span class="c1">###############</span>
<span class="c1">### Ndarray ###</span>
<span class="c1">###############</span>

<span class="c1">#use np.find_common_type to find a common type for the array</span>
<span class="k">def</span> <span class="nf">_new_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">void</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">dtype</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
            <span class="n">dtypedict</span> <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">fields</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="p">[</span><span class="n">dtypedict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">dtype</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="n">dtype</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="bp">NotImplemented</span><span class="p">(</span><span class="s1">&#39;dtype of type </span><span class="se">\&#39;</span><span class="s1">dict</span><span class="se">\&#39;</span><span class="s1"> are currently not supported&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Expected dtype got list&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Length of &quot;dtype&quot; argument does not match the number of keys&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[(</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">identifier</span><span class="p">(),</span> <span class="n">_new_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">))]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Could not convert &quot;</span><span class="si">{}</span><span class="s1">&quot; to numpy dtype&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[(</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">identifier</span><span class="p">(),</span> <span class="n">_new_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">))]</span>


<span class="k">def</span> <span class="nf">_new_keys</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">old_keys</span><span class="p">,</span> <span class="n">new_keys</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">old_keys</span><span class="p">,</span> <span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">void</span><span class="p">)):</span>
        <span class="n">old_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">old_keys</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">old_keys</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">old_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">old_keys</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">new_keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">old_keys</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_keys</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_keys</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Length of &quot;keys&quot; argument does not equal the number of keys in the array&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">new_keys</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_keys</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="bp">NotImplemented</span><span class="p">(</span><span class="s1">&#39;keys of type </span><span class="se">\&#39;</span><span class="s1">dict</span><span class="se">\&#39;</span><span class="s1"> are currently not supported&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&quot;keys&quot; argument has an invalid type </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_keys</span><span class="p">)))</span>


<span class="k">class</span> <span class="nc">IsopyNdarray</span><span class="p">(</span><span class="n">IsopyArray</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">values</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">ndim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ndim</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">values</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Negative size not allowed&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot create empty array: &quot;keys&quot; argument missing&#39;</span><span class="p">)</span>
            <span class="n">fkeys</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">float64</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">_new_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">fkeys</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">values</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot create a zero dimensional array with a size other than 1&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ndim</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">values</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">obj</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_ndarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span> <span class="ow">and</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ndim</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">void</span><span class="p">):</span>
            <span class="n">fkeys</span> <span class="o">=</span> <span class="n">_new_keys</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">_new_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">fkeys</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">_new_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">fkeys</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fkeys</span><span class="p">)):</span>
                <span class="n">obj</span><span class="p">[</span><span class="n">fkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">identifier</span><span class="p">()]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_ndarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="c1"># TODO do seperatley so that each key cna have a different dtype</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">_Table</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="c1">#values = {k: values.col(k) for k in values.colnames}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">float</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">dkeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dkeys</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">float</span>
            <span class="k">if</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">dkeys</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;keys&quot; argument can not be given together with a dict&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">object</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;dtype &quot;object&quot; not supported&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;values&quot; argument has to many dimensions (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>

                <span class="n">fkeys</span> <span class="o">=</span> <span class="n">_new_keys</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">_new_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">fkeys</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">_new_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">fkeys</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">ndim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span>
                <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">values</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot create a zero dimensional array with a size other than 1&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ndim</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">values</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fkeys</span><span class="p">)):</span>
                        <span class="n">obj</span><span class="p">[</span><span class="n">fkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">identifier</span><span class="p">()]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fkeys</span><span class="p">)):</span>
                        <span class="n">obj</span><span class="p">[</span><span class="n">fkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">identifier</span><span class="p">()]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>

                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_ndarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;values&quot; argument has to many dimensions (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;keys&quot; argument missing&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fkeys</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">_new_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">fkeys</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">_new_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">fkeys</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">nkeys</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">size</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">nvalues</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">nvalues</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">nkeys</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">nvalues</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nvalues</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot create a zero dimensional array with a size other than 1&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ndim</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">nvalues</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">nvalues</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="n">nkeys</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fkeys</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Size of the first dimension of &quot;values&quot; argument does not match the number of keys given&#39;</span><span class="p">)</span>

                <span class="n">obj</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nvalues</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fkeys</span><span class="p">)):</span>
                        <span class="n">obj</span><span class="p">[</span><span class="n">fkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">identifier</span><span class="p">()]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fkeys</span><span class="p">)):</span>
                        <span class="n">obj</span><span class="p">[</span><span class="n">fkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">identifier</span><span class="p">()]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>

                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_ndarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to create array with value type </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IsopyNdarray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="c1"># Can be smarter</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">identifiers</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_view</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">IsopyNdarray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__array_finalize__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only structured arrays can be used with this view&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">return</span> <span class="n">obj</span>


<span class="k">class</span> <span class="nc">MassNdarray</span><span class="p">(</span><span class="n">MassType</span><span class="p">,</span> <span class="n">IsopyNdarray</span><span class="p">,</span> <span class="n">MassArray</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">ElementNdarray</span><span class="p">(</span><span class="n">ElementType</span><span class="p">,</span> <span class="n">IsopyNdarray</span><span class="p">,</span> <span class="n">ElementArray</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">IsotopeNdarray</span><span class="p">(</span><span class="n">IsotopeType</span><span class="p">,</span> <span class="n">IsopyNdarray</span><span class="p">,</span> <span class="n">IsotopeArray</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">RatioNdarray</span><span class="p">(</span><span class="n">RatioType</span><span class="p">,</span> <span class="n">IsopyNdarray</span><span class="p">,</span> <span class="n">RatioArray</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="c1">############</span>
<span class="c1">### Void ###</span>
<span class="c1">############</span>

<span class="k">class</span> <span class="nc">IsopyVoid</span><span class="p">(</span><span class="n">IsopyArray</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">void</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">void</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">void</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="bp">cls</span><span class="p">,</span> <span class="n">void</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Should raise same error as ndarray</span>
        <span class="k">raise</span> <span class="bp">NotImplemented</span><span class="p">()</span>
        <span class="c1">#pass</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> cannot be indexed by position&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IsopyArray</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> cannot be indexed by position&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="c1"># Can be smarter</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="c1"># TODO check if it return IsopyVoid</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IsopyVoid</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MassVoid</span><span class="p">(</span><span class="n">MassType</span><span class="p">,</span> <span class="n">IsopyVoid</span><span class="p">,</span> <span class="n">MassArray</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">ElementVoid</span><span class="p">(</span><span class="n">ElementType</span><span class="p">,</span> <span class="n">IsopyVoid</span><span class="p">,</span> <span class="n">ElementArray</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">IsotopeVoid</span><span class="p">(</span><span class="n">IsotopeType</span><span class="p">,</span> <span class="n">IsopyVoid</span><span class="p">,</span> <span class="n">IsotopeArray</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">RatioVoid</span><span class="p">(</span><span class="n">RatioType</span><span class="p">,</span> <span class="n">IsopyVoid</span><span class="p">,</span> <span class="n">RatioArray</span><span class="p">):</span>
    <span class="k">pass</span>

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Mattias Ek

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>